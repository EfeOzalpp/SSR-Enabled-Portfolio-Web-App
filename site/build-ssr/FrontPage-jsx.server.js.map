{"version":3,"file":"FrontPage-jsx.server.js","mappings":"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","sources":["webpack://personal-site/./src/FrontPage.jsx","webpack://personal-site/./src/components/case-studies/load-focused-details.ts","webpack://personal-site/./src/utils/content-utility/color-map.ts","webpack://personal-site/./src/utils/content-utility/event-mount.tsx","webpack://personal-site/./src/utils/content-utility/lazy-in-view.tsx","webpack://personal-site/./src/utils/content-utility/lazy-view-mount.tsx","webpack://personal-site/./src/utils/content-utility/opacity-observer.tsx","webpack://personal-site/./src/utils/context-providers/project-context.tsx","webpack://personal-site/./src/utils/project-pane.tsx","webpack://personal-site/./src/utils/scroll-controller.tsx","webpack://personal-site/./src/utils/title/title-context.tsx","webpack://personal-site/./src/utils/title/title-observer.tsx","webpack://personal-site/./src/utils/title/view-project.tsx"],"sourcesContent":["import { useEffect } from 'react';\nimport loadable from '@loadable/component';\nimport ViewProject from './utils/title/view-project.tsx';\nimport { TitleProvider } from './utils/title/title-context.tsx';\nimport ScrollController from './utils/scroll-controller.tsx';\nimport { ProjectVisibilityProvider } from './utils/context-providers/project-context.tsx';\n\n// NavMenu is client-only; SSR markup stays identical.\nconst NavMenu = loadable(() => import('./utils/navigation/nav-menu.tsx'), {\n  ssr: false,\n  fallback: null,\n});\n\nfunction Frontpage() {\n  useEffect(() => {\n    // --- Clear prehydrate flag ASAP after hydration ---\n    const root = document.getElementById('landing');\n    requestAnimationFrame(() => root?.removeAttribute('data-prehydrate'));\n\n    // Allow pinch-zoom only inside elements that explicitly opt in.\n    const isAllowZoomTarget = (ev) => {\n      const el = ev?.target;\n      if (!el || typeof el.closest !== 'function') return false;\n      return Boolean(el.closest('[data-allow-zoom=\"1\"], .allow-pinch'));\n    };\n\n    // Prevent global pinch zoom (iOS/Android touchmove and Safari gesture*)\n    const preventPinchZoom = (event) => {\n      const tag = event?.target?.tagName?.toLowerCase?.() || '';\n      if (tag === 'video') return;                // let videos use native gestures\n      if (isAllowZoomTarget(event)) return;       // opt-in: allow inside pannable\n      if ('touches' in event && event.touches?.length > 1) event.preventDefault();\n    };\n\n    const preventGesture = (e) => {\n      // Safari iOS fires these for pinch\n      const tag = e?.target?.tagName?.toLowerCase?.() || '';\n      if (tag === 'video') return;\n      if (isAllowZoomTarget(e)) return;           // opt-in: allow inside pannable\n      e.preventDefault();\n    };\n\n    document.addEventListener('touchmove', preventPinchZoom, { passive: false });\n    document.addEventListener('gesturestart', preventGesture);\n    document.addEventListener('gesturechange', preventGesture);\n    document.addEventListener('gestureend', preventGesture);\n\n    return () => {\n      document.removeEventListener('touchmove', preventPinchZoom);\n      document.removeEventListener('gesturestart', preventGesture);\n      document.removeEventListener('gesturechange', preventGesture);\n      document.removeEventListener('gestureend', preventGesture);\n    };\n  }, []);\n\n  return (\n    <ProjectVisibilityProvider>\n      <div\n        className=\"HereGoesNothing\"\n        id=\"landing\"\n        data-prehydrate\n        style={{ position: 'relative' }}\n      >\n        <NavMenu />\n        <TitleProvider>\n          <ViewProject />\n        </TitleProvider>\n        <ScrollController />\n      </div>\n    </ProjectVisibilityProvider>\n  );\n}\n\nexport default Frontpage;\n","// Named chunk keeps it out of the main bundle and gives a stable file name.\r\nexport const loadFocusedDetails = () =>\r\n  import(/* webpackChunkName: \"focused-details\" */ '../case-studies/FocusedDetails');\r\n","// Master color config\r\nexport interface ProjectColor {\r\n  rgb: string;         // \"204, 85, 41\"\r\n  tooltipAlpha?: number;\r\n  defaultAlpha?: number;\r\n  darkThemeTop?: string; // optional override for theme-color\r\n}\r\n\r\nexport const projectColors: Record<string, ProjectColor> = {\r\n  'Rotary Lamp': {\r\n    rgb: '204, 85, 41',\r\n    tooltipAlpha: 0.6,\r\n    defaultAlpha: 0.6,\r\n    darkThemeTop: 'rgba(72, 161, 161, 1)'\r\n  },\r\n  'Ice Cream Scoop': {\r\n    rgb: '234, 103, 97',\r\n    tooltipAlpha: 0.6,\r\n    defaultAlpha: 0.6,\r\n    darkThemeTop: 'rgba(23, 27, 24, 1)'\r\n  },\r\n  'Data Visualization': {\r\n    rgb: '153, 199, 7',\r\n    tooltipAlpha: 0.8,\r\n    defaultAlpha: 0.6,\r\n    darkThemeTop: 'rgba(28, 30, 31, 1)'\r\n  },\r\n  'Evade the Rock': {\r\n    rgb: '101, 86, 175',\r\n    tooltipAlpha: 0.6,\r\n    defaultAlpha: 0.6,\r\n    darkThemeTop: 'rgb(25, 25, 25)'\r\n  },\r\n  'Dynamic App': {\r\n    rgb: '120, 211, 255',\r\n    tooltipAlpha: 0.6,\r\n    defaultAlpha: 0.6,\r\n    darkThemeTop: 'rgba(17, 17, 17, 1)'\r\n  }\r\n};\r\n","import { useEffect, useRef, useState, type ComponentType } from 'react';\r\n\r\ntype Props = {\r\n  /** dynamic import that returns { default: ReactComponent } */\r\n  load: () => Promise<{ default: ComponentType<any> }>;\r\n  /** when true: mount immediately; when false: unmount (but keep chunk in memory) */\r\n  active: boolean;\r\n  /** optional loading UI while the chunk fetches */\r\n  fallback?: React.ReactNode;\r\n  /** pass arbitrary props to the loaded component */\r\n  componentProps?: Record<string, any>;\r\n  /** simple fade; 0 disables */\r\n  fadeMs?: number;\r\n};\r\n\r\nexport default function EventMount({\r\n  load,\r\n  active,\r\n  fallback = null,\r\n  componentProps,\r\n  fadeMs = 200,\r\n}: Props) {\r\n  const [Comp, setComp] = useState<ComponentType<any> | null>(null);\r\n  const [visible, setVisible] = useState(false);\r\n  const loadingRef = useRef<Promise<any> | null>(null);\r\n\r\n  // Load code-split chunk when first activated\r\n  useEffect(() => {\r\n    if (!active) { setVisible(false); return; }\r\n    if (!Comp) {\r\n      if (!loadingRef.current) loadingRef.current = load().then(mod => {\r\n        setComp(() => mod.default);\r\n      });\r\n    }\r\n    // show as soon as we have the component\r\n    let alive = true;\r\n    (async () => {\r\n      if (!Comp && loadingRef.current) await loadingRef.current;\r\n      if (alive) setVisible(true);\r\n    })();\r\n    return () => { alive = false; };\r\n  }, [active, load, Comp]);\r\n\r\n  if (!active) return null;               // unmount when not active\r\n  if (!Comp) return <>{fallback}</>;      // show fallback until chunk arrives\r\n\r\n  return (\r\n    <div\r\n      style={{\r\n        opacity: fadeMs ? (visible ? 1 : 0) : 1,\r\n        transition: fadeMs ? `opacity ${fadeMs}ms ease` : undefined,\r\n        willChange: fadeMs ? 'opacity' : undefined,\r\n      }}\r\n    >\r\n      <Comp {...(componentProps ?? {})} />\r\n    </div>\r\n  );\r\n}\r\n","// src/utils/content-utility/lazy-in-view.tsx\r\nimport { useEffect, useRef, useState, Suspense, type ComponentType } from 'react';\r\n\r\ntype Props = {\r\n  load?: () => Promise<{ default: ComponentType<any> }>;\r\n  fallback?: React.ReactNode;\r\n  serverRender?: React.ReactNode; // SSR-provided markup for first paint\r\n  eager?: boolean;                // start visible immediately (SSR and client)\r\n  allowIdle?: boolean;\r\n\r\n  // NEW\r\n  observeTargetId?: string;      // observe external element if provided\r\n  rootMargin?: string;           // IO margin\r\n  threshold?: number | number[]; // IO threshold(s)\r\n  placeholderMinHeight?: number;\r\n  debugLabel?: string;           // console tag\r\n};\r\n\r\nconst hasWindow = typeof window !== 'undefined';\r\nconst hasRIC = hasWindow && 'requestIdleCallback' in (window as any);\r\nconst hasCIC = hasWindow && 'cancelIdleCallback' in (window as any);\r\nconst ric = (cb: any, opts?: any) =>\r\n  hasRIC ? (window as any).requestIdleCallback(cb, opts) : setTimeout(cb, opts?.timeout ?? 0);\r\nconst cic = (id: any) =>\r\n  hasCIC ? (window as any).cancelIdleCallback(id) : clearTimeout(id);\r\n\r\nexport default function LazyInView({\r\n  load,\r\n  fallback = null,\r\n  serverRender,\r\n  eager = false,\r\n  allowIdle = false,\r\n\r\n  observeTargetId,\r\n  rootMargin = '0px',\r\n  threshold = 0.05,\r\n  placeholderMinHeight = 360,\r\n  debugLabel,\r\n}: Props) {\r\n  const isServer = !hasWindow;\r\n\r\n  // Make SSR and client's first render agree:\r\n  // If we SSR-ed content (serverRender) or set eager, start visible; otherwise start hidden.\r\n  const initialVisible = eager || !!serverRender;\r\n  const [isVisible, setIsVisible] = useState<boolean>(initialVisible);\r\n\r\n  const [Component, setComponent] = useState<ComponentType | null>(null);\r\n  const selfRef = useRef<HTMLDivElement | null>(null);\r\n  const idleId = useRef<any>(null);\r\n\r\n  // IntersectionObserver: flip visible when in view\r\n  useEffect(() => {\r\n    // If already visible (SSR or eager), nothing to observe.\r\n    if (isVisible) return;\r\n\r\n    const target =\r\n      (observeTargetId ? document.getElementById(observeTargetId) : null) ||\r\n      selfRef.current;\r\n\r\n    if (!target || typeof IntersectionObserver === 'undefined') {\r\n      setIsVisible(true);\r\n      return;\r\n    }\r\n\r\n    const io = new IntersectionObserver(([entry]) => {\r\n      const vis = !!entry.isIntersecting;\r\n      const ratio = entry.intersectionRatio ?? 0;\r\n      if (debugLabel) console.log(`[LazyInView:${debugLabel}] IO`, { ratio, vis });\r\n\r\n      if (vis) {\r\n        setIsVisible(true);\r\n        io.disconnect();\r\n        if (idleId.current) {\r\n          cic(idleId.current);\r\n          idleId.current = null;\r\n        }\r\n      }\r\n    }, { threshold, root: null, rootMargin });\r\n\r\n    io.observe(target);\r\n    return () => io.disconnect();\r\n  }, [isVisible, observeTargetId, rootMargin, threshold, debugLabel]);\r\n\r\n  // Idle preloading (optional): if still hidden and allowed, show after an idle slot\r\n  useEffect(() => {\r\n    if (isVisible || !allowIdle) return;\r\n    idleId.current = ric(() => setIsVisible(true), { timeout: 2000 });\r\n    return () => {\r\n      if (idleId.current) {\r\n        cic(idleId.current);\r\n        idleId.current = null;\r\n      }\r\n    };\r\n  }, [isVisible, allowIdle]);\r\n\r\n  // Load component when visible\r\n  useEffect(() => {\r\n    if (!isVisible || Component || !load) return;\r\n    let cancelled = false;\r\n    load().then((mod) => { if (!cancelled) setComponent(() => mod.default); });\r\n    return () => { cancelled = true; };\r\n  }, [isVisible, Component, load]);\r\n\r\n  const content = Component\r\n    ? <Suspense fallback={fallback}><Component /></Suspense>\r\n    : (serverRender ?? fallback);\r\n\r\n  return (\r\n    <div\r\n      ref={selfRef}\r\n      className={debugLabel ? `liv--${debugLabel}` : undefined}\r\n      style={{\r\n        width: '100%',\r\n        height: '100%',\r\n        minHeight: placeholderMinHeight,\r\n        position: 'relative',\r\n        //  First render matches SSR exactly via initialVisible\r\n        opacity: isVisible ? 1 : 0,\r\n        transition: 'opacity 220ms ease',\r\n      }}\r\n    >\r\n      {content}\r\n    </div>\r\n  );\r\n}\r\n","// src/utils/content-utility/lazy-view-mount.tsx\r\nimport { useEffect, useRef, useState, Suspense, type ComponentType, lazy } from 'react';\r\n\r\ntype MountMode = 'io' | 'idle' | 'immediate';\r\n\r\ntype Props = {\r\n  load: () => Promise<{ default: ComponentType<any> }>;\r\n  fallback?: React.ReactNode;\r\n\r\n  /** Mount strategy */\r\n  mountMode?: MountMode;            // 'io' | 'idle' | 'immediate' (default 'io')\r\n\r\n  /** IO config (only when mountMode === 'io') */\r\n  enterThreshold?: number;          // default 0.2   -> start showing at/after this ratio\r\n  exitThreshold?: number;           // default 0.05  -> consider out-of-view at/below\r\n  unmountDelayMs?: number;          // default 150ms -> delay before unmounting after exit\r\n  root?: Element | null;            // viewport by default\r\n  rootMargin?: string;              // default '0px'\r\n  observeTargetId?: string;         // observe specific element; else our own wrapper\r\n\r\n  /** Preloading */\r\n  preloadOnIdle?: boolean;          // default true\r\n  preloadIdleTimeout?: number;      // default 2000\r\n  preloadOnFirstIO?: boolean;       // default true\r\n\r\n  /** Layout/UX */\r\n  placeholderMinHeight?: number;    // default 360\r\n  fadeMs?: number;                  // default 300\r\n  fadeEasing?: string;              // default 'ease'\r\n\r\n  /** Forward child props */\r\n  componentProps?: Record<string, any>;\r\n};\r\n\r\nconst hasWindow = typeof window !== 'undefined';\r\nconst hasRIC = hasWindow && 'requestIdleCallback' in (window as any);\r\nconst hasCIC = hasWindow && 'cancelIdleCallback' in (window as any);\r\nconst ric = (cb: any, opts?: any) =>\r\n  hasRIC ? (window as any).requestIdleCallback(cb, opts) : setTimeout(cb, opts?.timeout ?? 0);\r\nconst cic = (id: any) =>\r\n  hasCIC ? (window as any).cancelIdleCallback(id) : clearTimeout(id);\r\n\r\nexport default function LazyViewMount({\r\n  load,\r\n  fallback = null,\r\n\r\n  // strategy\r\n  mountMode = 'io',\r\n\r\n  // IO\r\n  enterThreshold = 0.2,\r\n  exitThreshold = 0.05,\r\n  unmountDelayMs = 150,\r\n  root = null,\r\n  rootMargin = '0px',\r\n  observeTargetId,\r\n\r\n  // preload\r\n  preloadOnIdle = true,\r\n  preloadIdleTimeout = 2000,\r\n  preloadOnFirstIO = true,\r\n\r\n  // layout/UX\r\n  placeholderMinHeight = 360,\r\n  fadeMs = 300,\r\n  fadeEasing = 'ease',\r\n\r\n  componentProps,\r\n}: Props) {\r\n  const isServer = !hasWindow;\r\n\r\n  const selfRef = useRef<HTMLDivElement | null>(null);\r\n  const [Comp, setComp] = useState<ComponentType | null>(null);\r\n\r\n  // mount/visibility\r\n  const mountedRef = useRef(false);\r\n  const [isMounted, setIsMounted] = useState(false);\r\n  const [isVisible, setIsVisible] = useState(false);\r\n\r\n  // timers\r\n  const unmountTimer = useRef<number | null>(null);\r\n  const fadeTimer = useRef<number | null>(null);\r\n  const idleId = useRef<any>(null);\r\n\r\n  // preload promise cache\r\n  const preloadPromiseRef = useRef<Promise<{ default: ComponentType<any> }> | null>(null);\r\n\r\n  // IO edge tracking\r\n  const lastRatio = useRef<number>(0);\r\n  const lastIntersecting = useRef<boolean>(false);\r\n  const firstIOSeen = useRef(false);\r\n\r\n  /** Preload once */\r\n  const ensurePreloaded = () => {\r\n    if (!preloadPromiseRef.current) {\r\n      preloadPromiseRef.current = load();\r\n    }\r\n    return preloadPromiseRef.current;\r\n  };\r\n\r\n  const clearTimers = () => {\r\n    if (unmountTimer.current != null) { window.clearTimeout(unmountTimer.current); unmountTimer.current = null; }\r\n    if (fadeTimer.current != null)     { window.clearTimeout(fadeTimer.current);   fadeTimer.current = null; }\r\n  };\r\n\r\n  const mountNow = () => {\r\n    if (mountedRef.current) {\r\n      // already mounted; just ensure visible\r\n      setIsVisible(true);\r\n      return;\r\n    }\r\n    mountedRef.current = true;\r\n    const p = ensurePreloaded();\r\n    setComp(prev => prev ?? (lazy(() => p) as unknown as ComponentType));\r\n    setIsMounted(true);\r\n    // next frame -> allow CSS transition\r\n    requestAnimationFrame(() => setIsVisible(true));\r\n  };\r\n\r\n  const unmountSoon = () => {\r\n    if (!mountedRef.current) return;\r\n    clearTimers();\r\n    // fade out -> unmount\r\n    unmountTimer.current = window.setTimeout(() => {\r\n      setIsVisible(false);\r\n      fadeTimer.current = window.setTimeout(() => {\r\n        setIsMounted(false);\r\n        mountedRef.current = false;\r\n      }, fadeMs);\r\n    }, unmountDelayMs);\r\n  };\r\n\r\n  /** Preload on idle */\r\n  useEffect(() => {\r\n    if (isServer || !preloadOnIdle) return;\r\n    if (idleId.current) cic(idleId.current);\r\n    idleId.current = ric(() => { void ensurePreloaded(); }, { timeout: preloadIdleTimeout });\r\n    return () => { if (idleId.current) { cic(idleId.current); idleId.current = null; } };\r\n  }, [isServer, preloadOnIdle, preloadIdleTimeout, load]);\r\n\r\n  /** Mount behavior per mode */\r\n  useEffect(() => {\r\n    if (isServer) return;\r\n\r\n    if (mountMode === 'immediate') {\r\n      mountNow();\r\n      return;\r\n    }\r\n\r\n    if (mountMode === 'idle') {\r\n      const id = ric(() => mountNow(), { timeout: preloadIdleTimeout });\r\n      return () => { if (id) cic(id); };\r\n    }\r\n\r\n    // ---- IO MODE ----\r\n    const target =\r\n      (observeTargetId ? document.getElementById(observeTargetId) : null) ||\r\n      selfRef.current;\r\n\r\n    if (!target) return;\r\n\r\n    if (typeof IntersectionObserver === 'undefined') {\r\n      // no IO support -> just mount\r\n      mountNow();\r\n      return;\r\n    }\r\n\r\n    // ensure sensible thresholds (enter > exit)\r\n    const enter = Math.max(0, Math.min(1, enterThreshold));\r\n    const exit  = Math.max(0, Math.min(enter, exitThreshold)); // cap at enter\r\n    const thresholds = Array.from(new Set([0, exit, enter, 1])).sort((a, b) => a - b);\r\n\r\n    const io = new IntersectionObserver(([entry]) => {\r\n      const ratio = entry?.intersectionRatio ?? 0;\r\n      const intersecting = !!entry?.isIntersecting;\r\n\r\n      // first IO  optional preload\r\n      if (!firstIOSeen.current) {\r\n        firstIOSeen.current = true;\r\n        if (preloadOnFirstIO) void ensurePreloaded();\r\n      }\r\n\r\n      // Compute edge crossings (prevents jitter in the gray zone)\r\n      const crossedEnter = lastRatio.current < enter && ratio >= enter;\r\n      const crossedExit  = lastRatio.current > exit  && ratio <= exit;\r\n      const becameIntersecting = !lastIntersecting.current && intersecting;\r\n      const leftIntersecting   = lastIntersecting.current && !intersecting;\r\n\r\n      // ENTER: on intersection or crossing the enter threshold\r\n      if (becameIntersecting || crossedEnter) {\r\n        clearTimers();\r\n        mountNow();\r\n      }\r\n      // EXIT: when leaving intersection OR crossing exit threshold\r\n      else if (leftIntersecting || crossedExit) {\r\n        unmountSoon();\r\n      }\r\n\r\n      // save last values\r\n      lastRatio.current = ratio;\r\n      lastIntersecting.current = intersecting;\r\n    }, { root, rootMargin, threshold: thresholds });\r\n\r\n    io.observe(target);\r\n    return () => { io.disconnect(); clearTimers(); };\r\n  }, [\r\n    isServer,\r\n    mountMode,\r\n    root,\r\n    rootMargin,\r\n    enterThreshold,\r\n    exitThreshold,\r\n    observeTargetId,\r\n    preloadIdleTimeout,\r\n    preloadOnFirstIO,\r\n    fadeMs,\r\n    unmountDelayMs,\r\n  ]);\r\n\r\n  const CompAny = Comp as any;\r\n\r\n  return (\r\n    <div\r\n      ref={selfRef}\r\n      style={{ width: '100%', minHeight: placeholderMinHeight, position: 'relative' }}\r\n    >\r\n      {isMounted && CompAny ? (\r\n        <div\r\n          style={{\r\n            opacity: isVisible ? 1 : 0,                 // 1 in view, 0 out of view\r\n            transition: `opacity ${fadeMs}ms ${fadeEasing}`,\r\n            willChange: 'opacity',\r\n          }}\r\n        >\r\n          <Suspense fallback={fallback}>\r\n            <CompAny {...(componentProps || {})} />\r\n          </Suspense>\r\n        </div>\r\n      ) : (\r\n        fallback\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n","// src/utils/content-utility/opacity-observer.ts\r\nexport const attachOpacityObserver = (\r\n  ids: string[],\r\n  focusedProjectKey: string | null\r\n) => {\r\n  const isRealMobile = (() => {\r\n    const coarse = window.matchMedia?.('(pointer: coarse)').matches ?? false;\r\n    const touch = (navigator as any).maxTouchPoints > 0;\r\n    const vv = (window as any).visualViewport;\r\n    let shrinks = false;\r\n    if (vv) {\r\n      const gap = window.innerHeight - vv.height;\r\n      if (gap > 48) shrinks = true;\r\n      return coarse && touch && (shrinks || gap > 48);\r\n    }\r\n    return coarse && touch;\r\n  })();\r\n\r\n  const baseMin = isRealMobile ? 0.1 : 0.3;\r\n  const focusedId = focusedProjectKey ? `block-${focusedProjectKey}` : null;\r\n\r\n  // Per-call guard so re-attaching after focus toggles works\r\n  const observed = new WeakSet<HTMLElement>();\r\n\r\n  const observer = new IntersectionObserver(\r\n    (entries) => {\r\n      for (const entry of entries) {\r\n        const el = entry.target as HTMLElement;\r\n        const ratio = entry.intersectionRatio ?? 0;\r\n\r\n        // Focused pane is always fully opaque\r\n        if (focusedId && el.id === focusedId) {\r\n          el.style.opacity = '1';\r\n          continue;\r\n        }\r\n\r\n        // Everyone else keeps mapping based on IO even while focused\r\n        if (ratio >= 0.75) {\r\n          el.style.opacity = '1';\r\n        } else {\r\n          const mapped = baseMin + (ratio / 0.75) * (1 - baseMin);\r\n          el.style.opacity = String(mapped);\r\n        }\r\n      }\r\n    },\r\n    {\r\n      threshold: Array.from({ length: 101 }, (_, i) => i / 100),\r\n      // If your panes live inside a custom scroller, pass it here as `root`\r\n      // root: scrollContainerRef.current,\r\n    }\r\n  );\r\n\r\n  const observeTargets = () => {\r\n    ids.forEach((sel) => {\r\n      const el = document.querySelector(sel) as HTMLElement | null;\r\n      if (el && !observed.has(el)) {\r\n        observed.add(el);\r\n        observer.observe(el);\r\n        // Prime the focused pane immediately so theres no flash\r\n        if (focusedId && el.id === focusedId) el.style.opacity = '1';\r\n      }\r\n    });\r\n  };\r\n\r\n  const mo = new MutationObserver(observeTargets);\r\n  observeTargets();\r\n  mo.observe(document.body, { childList: true, subtree: true });\r\n\r\n  return () => {\r\n    observer.disconnect();\r\n    mo.disconnect();\r\n  };\r\n};\r\n","// src/utils/context-providers/project-context.tsx\r\nimport React, {\r\n  createContext,\r\n  useState,\r\n  useContext,\r\n  useRef,\r\n  ReactNode,\r\n} from 'react';\r\n\r\ntype ViewportAlignArgs = {\r\n  /** Prefer one of these to identify the block to align */\r\n  id?: string;              // e.g. 'block-game'\r\n  key?: string;             // e.g. 'game' -> resolves to #block-game in your aligner\r\n  el?: HTMLElement | null;  // direct element if you have it\r\n  /** Re-verify/re-apply on next rAF (helps on mobile Safari) */\r\n  retry?: boolean;\r\n};\r\n\r\ninterface ProjectVisibilityContextType {\r\n  activeProject?: string;\r\n  setActiveProject: (title: string) => void;\r\n\r\n  blockGClick: boolean;\r\n  setBlockGClick: (clicked: boolean) => void;\r\n\r\n  currentIndex: number;\r\n  setCurrentIndex: React.Dispatch<React.SetStateAction<number>>;\r\n\r\n  scrollContainerRef: React.RefObject<HTMLDivElement>;\r\n\r\n  isDragging: boolean;\r\n  setIsDragging: React.Dispatch<React.SetStateAction<boolean>>;\r\n\r\n  focusedProjectKey: string | null;\r\n  setFocusedProjectKey: React.Dispatch<React.SetStateAction<string | null>>;\r\n\r\n  previousScrollY: number | null;\r\n  setPreviousScrollY: React.Dispatch<React.SetStateAction<number | null>>;\r\n\r\n  /** Ask ScrollController to instantly align a block to the top (no smooth, no bump) */\r\n  requestViewportAlign: (args: ViewportAlignArgs) => void;\r\n\r\n  /**\r\n   * Register the actual align function (implemented inside ScrollController).\r\n   * ScrollController should call this once on mount and clean up on unmount.\r\n   */\r\n  registerViewportAlign: (fn: (args: ViewportAlignArgs) => void) => void;\r\n}\r\n\r\ninterface ProjectVisibilityProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nconst ProjectVisibilityContext = createContext<ProjectVisibilityContextType | undefined>(undefined);\r\n\r\nexport const ProjectVisibilityProvider = ({ children }: ProjectVisibilityProviderProps) => {\r\n  const [activeProject, setActiveProject] = useState<string | undefined>(undefined);\r\n  const [blockGClick, setBlockGClick] = useState(false);\r\n  const [currentIndex, setCurrentIndex] = useState(0);\r\n  const [isDragging, setIsDragging] = useState(false);\r\n  const [focusedProjectKey, setFocusedProjectKey] = useState<string | null>(null);\r\n  const [previousScrollY, setPreviousScrollY] = useState<number | null>(null);\r\n\r\n  const scrollContainerRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // The ScrollController will register its implementation here.\r\n  const alignFnRef = useRef<(args: ViewportAlignArgs) => void>(() => { /* no-op by default */ });\r\n\r\n  const requestViewportAlign = React.useCallback((args: ViewportAlignArgs) => {\r\n    alignFnRef.current?.(args);\r\n  }, []);\r\n\r\n  const registerViewportAlign = React.useCallback((fn: (args: ViewportAlignArgs) => void) => {\r\n    alignFnRef.current = fn || (() => {});\r\n  }, []);\r\n\r\n  return (\r\n    <ProjectVisibilityContext.Provider\r\n      value={{\r\n        activeProject,\r\n        setActiveProject,\r\n        blockGClick,\r\n        setBlockGClick,\r\n        currentIndex,\r\n        setCurrentIndex,\r\n        scrollContainerRef,\r\n        isDragging,\r\n        setIsDragging,\r\n        focusedProjectKey,\r\n        setFocusedProjectKey,\r\n        previousScrollY,\r\n        setPreviousScrollY,\r\n        requestViewportAlign,\r\n        registerViewportAlign,\r\n      }}\r\n    >\r\n      {children}\r\n    </ProjectVisibilityContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useProjectVisibility = () => {\r\n  const context = useContext(ProjectVisibilityContext);\r\n  if (!context) {\r\n    throw new Error('useProjectVisibility must be used within ProjectVisibilityProvider');\r\n  }\r\n  return context;\r\n};\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport LazyInView from './content-utility/lazy-in-view';\r\nimport LazyViewMount from './content-utility/lazy-view-mount';\r\nimport LoadingScreen from './loading/loading';\r\nimport { useProjectLoader } from './content-utility/component-loader';\r\nimport { useSsrData } from './context-providers/ssr-data-context';\r\nimport { ssrRegistry } from '../ssr/registry';\r\n\r\n/* event-driven details for case study section */\r\nimport EventMount from './content-utility/event-mount';\r\nimport { loadFocusedDetails } from '../components/case-studies/load-focused-details';\r\n\r\ntype Props = {\r\n  item: any;\r\n  isFocused: boolean;\r\n  setRef: (el: HTMLDivElement | null) => void;\r\n  isFirst?: boolean;\r\n};\r\n\r\nexport function ProjectPane({\r\n  item,\r\n  isFocused,\r\n  setRef,\r\n  isFirst = false,\r\n}: Props) {\r\n  const load = useProjectLoader(item.key);\r\n  const ssr = useSsrData();\r\n  const payload = ssr?.preloaded?.[item.key];\r\n  const desc = ssrRegistry[item.key];\r\n  const hasSSR = Boolean(payload && desc?.render);\r\n\r\n  const [isHydrated, setIsHydrated] = useState(false);\r\n  useEffect(() => { setIsHydrated(true); }, []);\r\n\r\n  const serverRender =\r\n    payload && desc?.render ? desc.render((payload as any).data ?? payload) : null;\r\n\r\n  const isDynamic = item.key === 'dynamic';\r\n  const isGame = item.key === 'game';\r\n  const usesCustomLoader = isDynamic || isGame;\r\n\r\n  const fallbackNode =\r\n    !payload && isHydrated && !usesCustomLoader ? (\r\n      <LoadingScreen isFullScreen={false} />\r\n    ) : null;\r\n\r\n  const blockId = `block-${item.key}`;\r\n  const rootRef = useRef<HTMLDivElement | null>(null);\r\n\r\n  // --- NEW: delay unmount of focused details on unfocus ---\r\n  const EXIT_DELAY_MS = 500; // tweak as you like\r\n  const [activeDelayed, setActiveDelayed] = useState<boolean>(isFocused);\r\n  const exitTimerRef = useRef<number | null>(null);\r\n\r\n  useEffect(() => {\r\n    // when focused: cancel any pending turn-off and show immediately\r\n    if (isFocused) {\r\n      if (exitTimerRef.current) {\r\n        clearTimeout(exitTimerRef.current);\r\n        exitTimerRef.current = null;\r\n      }\r\n      setActiveDelayed(true);\r\n    } else {\r\n      // when unfocusing: wait a bit before turning details off\r\n      exitTimerRef.current = window.setTimeout(() => {\r\n        setActiveDelayed(false);\r\n        exitTimerRef.current = null;\r\n      }, EXIT_DELAY_MS);\r\n    }\r\n\r\n    return () => {\r\n      if (exitTimerRef.current) {\r\n        clearTimeout(exitTimerRef.current);\r\n        exitTimerRef.current = null;\r\n      }\r\n    };\r\n  }, [isFocused]);\r\n\r\n  // intrinsic size hint to keep content-visibility stable\r\n  useEffect(() => {\r\n    const el = rootRef.current;\r\n    if (!el || typeof ResizeObserver === 'undefined') return;\r\n    const ro = new ResizeObserver(() => {\r\n      const h = el.offsetHeight || 0;\r\n      el.style.setProperty('--cis-block', `${Math.max(400, h)}px`);\r\n    });\r\n    ro.observe(el);\r\n    return () => ro.disconnect();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (isFocused) { loadFocusedDetails(); }\r\n  }, [isFocused]);\r\n\r\n  return (\r\n    <div\r\n      id={blockId}\r\n      ref={(el) => { setRef(el); rootRef.current = el; }}\r\n      className={`project-pane ${isFocused ? 'is-focused' : ''}`}\r\n      style={{\r\n        scrollSnapAlign: 'start',\r\n        scrollSnapStop: 'always',\r\n        contentVisibility: 'auto' as any,\r\n        containIntrinsicSize: 'var(--cis-block, 600px)',\r\n        contain: 'layout paint style',\r\n        overflow: isFocused ? 'visible' : 'hidden',\r\n      }}\r\n    >\r\n      <div className=\"project-pane-wrapper\">\r\n        {isDynamic ? (\r\n          <>\r\n            <LazyInView\r\n              load={load}\r\n              serverRender={serverRender}\r\n              eager={isFirst}\r\n              allowIdle\r\n            />\r\n            {!hasSSR && (\r\n              <LazyViewMount\r\n                load={() => import('../components/dynamic-app/shadow-entry')}\r\n                mountMode=\"idle\"\r\n                preloadOnIdle\r\n                preloadIdleTimeout={2000}\r\n                preloadOnFirstIO\r\n                observeTargetId={blockId}\r\n                rootMargin=\"0px\"\r\n                placeholderMinHeight={0}\r\n                componentProps={{ blockId }}\r\n              />\r\n            )}\r\n          </>\r\n        ) : isGame ? (\r\n          <LazyInView\r\n            load={load}\r\n            serverRender={serverRender}\r\n            eager={isFirst}\r\n            allowIdle\r\n            observeTargetId={blockId}\r\n            placeholderMinHeight={0}\r\n          />\r\n        ) : (\r\n          <LazyInView\r\n            load={load}\r\n            fallback={fallbackNode}\r\n            serverRender={serverRender}\r\n            eager={isFirst}\r\n            allowIdle={false}\r\n            placeholderMinHeight={0}\r\n          />\r\n        )}\r\n      </div>\r\n\r\n      {/* optional: details under focused pane */}\r\n      <EventMount\r\n        load={loadFocusedDetails}\r\n        active={activeDelayed}                 \r\n        fallback={<div style={{ height: '100dvh' }} />}\r\n        componentProps={{ title: item.title ?? item.key }}\r\n        fadeMs={400}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","// src/utils/scroll-controller.tsx\r\nimport { useEffect, useRef, useState, useMemo } from 'react';\r\nimport { useProjectVisibility } from './context-providers/project-context';\r\nimport { attachOpacityObserver } from './content-utility/opacity-observer';\r\nimport { baseProjects } from './content-utility/component-loader';\r\nimport { ProjectPane } from './project-pane';\r\nimport { useSsrData } from './context-providers/ssr-data-context';\r\nimport { seededShuffle } from './seed';\r\n\r\n/* ===========================\r\n   Synthetic Drag & Exit Events\r\n   =========================== */\r\ndeclare global {\r\n  interface DocumentEventMap {\r\n    'synthetic-drag': CustomEvent<{\r\n      phase: 'start' | 'move' | 'end';\r\n      direction: 'up' | 'down';\r\n      magnitude: number;     // px intention applied to the OUTER scroller\r\n      velocity?: number;     // px/ms (optional)\r\n      source: 'touch' | 'wheel';\r\n      ts: number;            // performance.now()\r\n    }>;\r\n    'focus-exit-start': CustomEvent<{ key: string }>;\r\n    'focus-exit-unlock': CustomEvent<{ key: string }>;\r\n  }\r\n}\r\n\r\nconst ScrollController = () => {\r\n  const { scrollContainerRef, focusedProjectKey, currentIndex, setFocusedProjectKey } =\r\n    useProjectVisibility();\r\n  const { seed = 12345 } = useSsrData() || {};\r\n\r\n  // Shuffle once on mount; never recompute order during this session\r\n  const projectsRef = useRef(seededShuffle(baseProjects, seed));\r\n  const projects = projectsRef.current;\r\n\r\n  // Keep DOM refs to each block for precise scrolling\r\n  const projectRefs = useRef<Record<string, HTMLDivElement | null>>({});\r\n\r\n  // Track last outer scrollTop and direction while focused\r\n  const lastScrollTopRef = useRef<number>(0);\r\n  const lastScrollDirRef = useRef<'up' | 'down'>('down');\r\n\r\n  // ---- Tunables ----\r\n  const VIS_RATIO_TO_EXIT = 0.2;     // 20% of any OTHER pane => auto-unfocus\r\n  const VIS_DWELL_MS      = 120;     // must remain candidate for this long\r\n  const MAX_UNLOCK_VH     = 0.90;    // 90dvh movement cap before details unmount\r\n  const MIN_LINGER_MS     = 280;     // require at least this much time before unlock\r\n  const MAX_LINGER_MS     = 800;     // (optional) don't linger longer than this\r\n  const SNAP_RAMP_MS      = 400;     // proximity ramp\r\n  const SNAP_KB_FALLBACK_MS = 1200;  // snap re-enable fallback\r\n  const UNLOCK_FALLBACK_MS  = 1400;  // unlock fallback if scroll events dont fire\r\n\r\n  // Track the last non-null focused key so we can anchor (fallback) on exit\r\n  const lastFocusedKeyRef = useRef<string | null>(null);\r\n  useEffect(() => {\r\n    if (focusedProjectKey) lastFocusedKeyRef.current = focusedProjectKey;\r\n  }, [focusedProjectKey]);\r\n\r\n  // Preferred exit target (set when user scrolls away during focus)\r\n  const exitTargetKeyRef = useRef<string | null>(null);\r\n\r\n  // Helper: element's offsetTop within a custom scroller\r\n  const getOffsetTopWithin = (el: HTMLElement, scroller: HTMLElement | any) => {\r\n    const r1 = el.getBoundingClientRect();\r\n    const r2 = (scroller as HTMLElement).getBoundingClientRect?.() ?? { top: 0 };\r\n    const st = ('scrollTop' in scroller ? scroller.scrollTop : document.documentElement.scrollTop) || 0;\r\n    return r1.top - r2.top + st;\r\n  };\r\n\r\n  // Temporarily disable snap after index changes, to allow smooth momentum handoff\r\n  // Only do this while focused; when NOT focused we want strong snap.\r\n  useEffect(() => {\r\n    const container = scrollContainerRef.current;\r\n    if (!container) return;\r\n    if (!focusedProjectKey) return; // keep snap strong outside focus\r\n    container.classList.add('no-snap');\r\n    const timeout = setTimeout(() => container.classList.remove('no-snap'), 800);\r\n    return () => clearTimeout(timeout);\r\n  }, [currentIndex, focusedProjectKey, scrollContainerRef]);\r\n\r\n  /* ===========================\r\n     Focus entry scroll choreography\r\n     - On entering focus: align the focused block, then bump ~90dvh\r\n     =========================== */\r\n  useEffect(() => {\r\n    if (!focusedProjectKey) return;\r\n\r\n    const scroller = scrollContainerRef.current ?? (document.scrollingElement as any);\r\n    if (!scroller) return;\r\n\r\n    const targetEl =\r\n      projectRefs.current[focusedProjectKey] ??\r\n      (document.getElementById(`block-${focusedProjectKey}`) as HTMLDivElement | null);\r\n\r\n    const getViewportH = () =>\r\n      (scroller?.clientHeight as number) ||\r\n      (scroller?.getBoundingClientRect?.().height as number) ||\r\n      (window.visualViewport?.height ?? window.innerHeight ?? document.documentElement.clientHeight ?? 0);\r\n\r\n    requestAnimationFrame(() => {\r\n      if (targetEl?.scrollIntoView) {\r\n        targetEl.scrollIntoView({ block: 'start', behavior: 'smooth' });\r\n      }\r\n      const bump = Math.round(getViewportH() * 0.9);\r\n      requestAnimationFrame(() => {\r\n        requestAnimationFrame(() => {\r\n          scroller.scrollBy?.({ top: bump, left: 0, behavior: 'smooth' });\r\n        });\r\n      });\r\n    });\r\n  }, [focusedProjectKey, scrollContainerRef]);\r\n\r\n  // --------------------------\r\n  // Scrolling helpers\r\n  // --------------------------\r\n  const setScrollTop = (scroller: any, top: number) => {\r\n    if ('scrollTop' in scroller) {\r\n      scroller.scrollTop = top;\r\n    } else {\r\n      scroller.scrollTo?.({ top, left: 0, behavior: 'auto' });\r\n    }\r\n  };\r\n\r\n  // Kill inertia, then instantly place (used for re-anchors after layout changes)\r\n  const hardPlaceAtKey = (key: string) => {\r\n    const scroller = scrollContainerRef.current ?? (document.scrollingElement as any);\r\n    if (!scroller) return;\r\n    const el =\r\n      projectRefs.current[key] ??\r\n      (document.getElementById(`block-${key}`) as HTMLDivElement | null);\r\n    if (!el) return;\r\n\r\n    const targetTop = getOffsetTopWithin(el, scroller);\r\n\r\n    const prevBehavior = (scroller as HTMLElement).style.scrollBehavior;\r\n    const prevOverflow = (scroller as HTMLElement).style.overflowY;\r\n\r\n    (scroller as HTMLElement).style.scrollBehavior = 'auto';\r\n    (scroller as HTMLElement).style.overflowY = 'hidden';\r\n    // @ts-ignore force sync\r\n    void scroller.offsetHeight;\r\n\r\n    setScrollTop(scroller, targetTop);\r\n\r\n    // @ts-ignore force sync\r\n    void scroller.offsetHeight;\r\n\r\n    (scroller as HTMLElement).style.overflowY = prevOverflow || 'scroll';\r\n    (scroller as HTMLElement).style.scrollBehavior = prevBehavior || '';\r\n\r\n    lastScrollTopRef.current = scroller.scrollTop || 0;\r\n  };\r\n\r\n  // Kill inertia, then tween to a key over ~260ms ease-out (nice transition)\r\n  const animatePlaceToKey = (key: string, ms = 260) => {\r\n    const scroller = scrollContainerRef.current ?? (document.scrollingElement as any);\r\n    if (!scroller) return;\r\n\r\n    const el =\r\n      projectRefs.current[key] ??\r\n      (document.getElementById(`block-${key}`) as HTMLDivElement | null);\r\n    if (!el) return;\r\n\r\n    const targetTop = getOffsetTopWithin(el, scroller);\r\n    const startTop = scroller.scrollTop || 0;\r\n    const delta = targetTop - startTop;\r\n    if (Math.abs(delta) < 1) {\r\n      hardPlaceAtKey(key);\r\n      return;\r\n    }\r\n\r\n    const reduce =\r\n      typeof window !== 'undefined' &&\r\n      (window.matchMedia?.('(prefers-reduced-motion: reduce)').matches ?? false);\r\n\r\n    const duration = reduce ? 80 : ms;\r\n    const start = performance.now();\r\n\r\n    const prevBehavior = (scroller as HTMLElement).style.scrollBehavior;\r\n    const prevOverflow = (scroller as HTMLElement).style.overflowY;\r\n    (scroller as HTMLElement).style.scrollBehavior = 'auto';\r\n    (scroller as HTMLElement).style.overflowY = 'hidden';\r\n\r\n    // cubic ease-out\r\n    const easeOutCubic = (t: number) => 1 - Math.pow(1 - t, 3);\r\n\r\n    let raf = 0;\r\n    const step = (now: number) => {\r\n      const t = Math.min(1, (now - start) / duration);\r\n      const y = startTop + delta * easeOutCubic(t);\r\n      setScrollTop(scroller, y);\r\n      if (t < 1) {\r\n        raf = requestAnimationFrame(step);\r\n      } else {\r\n        // restore\r\n        (scroller as HTMLElement).style.overflowY = prevOverflow || 'scroll';\r\n        (scroller as HTMLElement).style.scrollBehavior = prevBehavior || '';\r\n        lastScrollTopRef.current = scroller.scrollTop || 0;\r\n      }\r\n    };\r\n\r\n    // start\r\n    // @ts-ignore\r\n    void scroller.offsetHeight;\r\n    raf = requestAnimationFrame(step);\r\n    return () => raf && cancelAnimationFrame(raf);\r\n  };\r\n\r\n  /* ===========================\r\n     AUTO-UNFOCUS while focused:\r\n     - If any OTHER pane is  20% visible (and remains for VIS_DWELL_MS),\r\n       we exit focus and force the exit target to the *adjacent* pane\r\n       in the scroll direction (no skipping).\r\n     =========================== */\r\n  useEffect(() => {\r\n    const scroller = scrollContainerRef.current ?? (document.scrollingElement as any);\r\n    if (!focusedProjectKey || !scroller) return;\r\n\r\n    let raf = 0;\r\n    let dwellTimer: number | null = null;\r\n    let pendingKey: string | null = null;\r\n\r\n    const getViewportH = () =>\r\n      (scroller?.clientHeight as number) ||\r\n      (scroller?.getBoundingClientRect?.().height as number) ||\r\n      (window.visualViewport?.height ?? window.innerHeight ?? document.documentElement.clientHeight ?? 0);\r\n\r\n    const focusedIdx = projects.findIndex(p => p.key === focusedProjectKey);\r\n    const clampAdjacentKey = (dir: 'up' | 'down') => {\r\n      if (focusedIdx < 0) return null;\r\n      const nextIdx = dir === 'down' ? Math.min(focusedIdx + 1, projects.length - 1)\r\n                                     : Math.max(focusedIdx - 1, 0);\r\n      if (nextIdx === focusedIdx) return null;\r\n      return projects[nextIdx].key;\r\n    };\r\n\r\n    const pickCandidate = () => {\r\n      const vh = getViewportH();\r\n      const viewportCenter = vh * 0.5;\r\n\r\n      let bestKey: string | null = null;\r\n      let bestDist = Infinity;\r\n\r\n      for (const p of projects) {\r\n        if (p.key === focusedProjectKey) continue;\r\n        const el = document.getElementById(`block-${p.key}`) as HTMLElement | null;\r\n        if (!el) continue;\r\n\r\n        const r = el.getBoundingClientRect();\r\n        if (r.bottom <= 0 || r.top >= vh) continue;\r\n\r\n        const visible = Math.min(r.bottom, vh) - Math.max(r.top, 0);\r\n        const ratio = Math.max(0, visible) / Math.max(1, r.height);\r\n        if (ratio < VIS_RATIO_TO_EXIT) continue;\r\n\r\n        const center = r.top + r.height / 2;\r\n        const dist = Math.abs(center - viewportCenter);\r\n        if (dist < bestDist) {\r\n          bestDist = dist;\r\n          bestKey = p.key;\r\n        }\r\n      }\r\n      return bestKey;\r\n    };\r\n\r\n    const onTick = () => {\r\n      raf = 0;\r\n      const curr = scroller.scrollTop || 0;\r\n      const dir: 'up' | 'down' = curr < lastScrollTopRef.current ? 'up'\r\n                            : curr > lastScrollTopRef.current ? 'down'\r\n                            : lastScrollDirRef.current;\r\n      lastScrollDirRef.current = dir;\r\n      lastScrollTopRef.current = curr;\r\n\r\n      const anyVisibleOther = Boolean(pickCandidate());\r\n      if (anyVisibleOther) {\r\n        const neighbor = clampAdjacentKey(dir) ?? pickCandidate();\r\n        if (neighbor && pendingKey !== neighbor) {\r\n          pendingKey = neighbor;\r\n          if (dwellTimer) window.clearTimeout(dwellTimer);\r\n          dwellTimer = window.setTimeout(() => {\r\n            exitTargetKeyRef.current = neighbor; // lock to adjacent pane\r\n            setFocusedProjectKey(null);          // triggers robust exit\r\n          }, VIS_DWELL_MS);\r\n        }\r\n      } else {\r\n        pendingKey = null;\r\n        if (dwellTimer) {\r\n          window.clearTimeout(dwellTimer);\r\n          dwellTimer = null;\r\n        }\r\n      }\r\n    };\r\n\r\n    const onScroll = () => { if (!raf) raf = requestAnimationFrame(onTick); };\r\n\r\n    scroller.addEventListener('scroll', onScroll, { passive: true });\r\n    onScroll(); // prime once\r\n\r\n    return () => {\r\n      scroller.removeEventListener('scroll', onScroll as any);\r\n      if (raf) cancelAnimationFrame(raf);\r\n      if (dwellTimer) window.clearTimeout(dwellTimer);\r\n    };\r\n  }, [focusedProjectKey, projects, scrollContainerRef, setFocusedProjectKey]);\r\n\r\n  /* ===========================\r\n     Focus EXIT choreography (robust)\r\n     - Tween to adjacent pane (soft), cancel inertia first\r\n     - Re-anchor after the old focused block collapses (hard)\r\n     =========================== */\r\n  useEffect(() => {\r\n    const container = scrollContainerRef.current;\r\n    if (!container) return;\r\n\r\n    // Only act when we EXIT focus (focusedProjectKey === null)\r\n    if (focusedProjectKey) return;\r\n\r\n    const preferredKey = exitTargetKeyRef.current || lastFocusedKeyRef.current;\r\n    if (!preferredKey) return;\r\n\r\n    const scroller = scrollContainerRef.current ?? (document.scrollingElement as any);\r\n\r\n    // Prevent native snap fighting us during the handoff\r\n    container.classList.add('no-snap');\r\n\r\n    // Tell panes which key is exiting (kept for existing listeners)\r\n    document.dispatchEvent(new CustomEvent('focus-exit-start', { detail: { key: preferredKey } }));\r\n\r\n    // 1) Tween to the intended neighbor after killing inertia\r\n    const cancelTween = animatePlaceToKey(preferredKey, 260);\r\n\r\n    // 2) Re-anchor once the old focused block actually shrinks (details unmount)\r\n    const oldKey = lastFocusedKeyRef.current;\r\n    const oldEl = oldKey\r\n      ? (projectRefs.current[oldKey] ??\r\n         (document.getElementById(`block-${oldKey}`) as HTMLDivElement | null))\r\n      : null;\r\n\r\n    let ro: ResizeObserver | null = null;\r\n    if (oldEl && typeof ResizeObserver !== 'undefined') {\r\n      let prevH = oldEl.offsetHeight || 0;\r\n      ro = new ResizeObserver(() => {\r\n        const h = oldEl.offsetHeight || 0;\r\n        // height dropped => layout shifted; re-anchor once\r\n        if (h < prevH - 8) {\r\n          hardPlaceAtKey(preferredKey);\r\n          ro?.disconnect();\r\n          ro = null;\r\n        }\r\n        prevH = h;\r\n      });\r\n      ro.observe(oldEl);\r\n    }\r\n\r\n    // 3) Small dwell, then unlock + gently re-enable snapping (proximity ramp)\r\n    const unlockTimer = setTimeout(() => {\r\n      document.dispatchEvent(new CustomEvent('focus-exit-unlock', { detail: { key: preferredKey } }));\r\n\r\n      requestAnimationFrame(() => {\r\n        container.classList.add('snap-proximity');\r\n        container.classList.remove('no-snap');\r\n        const ramp = setTimeout(() => container.classList.remove('snap-proximity'), SNAP_RAMP_MS);\r\n        cleanupFns.push(() => clearTimeout(ramp));\r\n      });\r\n\r\n      // Clear the used target\r\n      exitTargetKeyRef.current = null;\r\n    }, MIN_LINGER_MS);\r\n\r\n    // Fallback re-anchor in case RO is not available / missed (covers EXIT_DELAY_MS + fade)\r\n    const postTimer = setTimeout(() => hardPlaceAtKey(preferredKey), 900);\r\n\r\n    const cleanupFns: Array<() => void> = [\r\n      () => typeof cancelTween === 'function' && cancelTween(),\r\n      () => clearTimeout(unlockTimer),\r\n      () => clearTimeout(postTimer),\r\n      () => ro?.disconnect?.(),\r\n    ];\r\n\r\n    return () => {\r\n      cleanupFns.forEach(fn => fn());\r\n    };\r\n  }, [focusedProjectKey, scrollContainerRef]);\r\n\r\n  /* ===========================\r\n     Edge signalling only (no cancel, no programmatic scroll)\r\n     (rebinding-safe version so it survives DOM swaps)\r\n     =========================== */\r\n  useEffect(() => {\r\n    const scrollContainer = scrollContainerRef.current;\r\n    if (!scrollContainer) return;\r\n\r\n    let attachedEl: HTMLElement | null = null;\r\n\r\n    const atTop = (el: HTMLElement) => el.scrollTop <= 0;\r\n    const atBottom = (el: HTMLElement) => {\r\n      // DPR-aware cushion so sticky/footer/safe-area rounding doesn't block the handoff\r\n      const EPS = Math.max(16, Math.ceil((window.devicePixelRatio || 1) * 20)); // ~1624px\r\n      const max = el.scrollHeight - el.clientHeight;\r\n      return (max - el.scrollTop) <= EPS;\r\n    };\r\n\r\n    const fireSyntheticDrag = (\r\n      phase: 'start' | 'move' | 'end',\r\n      direction: 'up' | 'down',\r\n      magnitude: number,\r\n      source: 'touch' | 'wheel',\r\n      velocity?: number\r\n    ) => {\r\n      const evt = new CustomEvent('synthetic-drag', {\r\n        detail: { phase, direction, magnitude, velocity, source, ts: performance.now() },\r\n        bubbles: true,\r\n        composed: true,\r\n      });\r\n      scrollContainer.dispatchEvent(evt);\r\n    };\r\n\r\n    let lastY = 0;\r\n    let lastTs = 0;\r\n\r\n    const handleTouchStart = (e: TouchEvent) => {\r\n      if (!attachedEl) return;\r\n      if (e.touches.length === 1) {\r\n        lastY = e.touches[0].clientY;\r\n        lastTs = performance.now();\r\n        fireSyntheticDrag('start', 'down', 0, 'touch');\r\n      }\r\n    };\r\n\r\n    const handleTouchMove = (e: TouchEvent) => {\r\n      if (!attachedEl) return;\r\n      if (e.touches.length !== 1) return;\r\n      const y = e.touches[0].clientY;\r\n      const dy = y - lastY; // >0 down, <0 up\r\n      const now = performance.now();\r\n      const dt = Math.max(1, now - lastTs);\r\n      const velocity = Math.abs(dy) / dt;\r\n      lastY = y;\r\n      lastTs = now;\r\n\r\n      if ((dy > 0 && atTop(attachedEl)) || (dy < 0 && atBottom(attachedEl))) {\r\n        fireSyntheticDrag('move', dy < 0 ? 'down' : 'up', Math.min(600, Math.abs(dy)), 'touch', velocity);\r\n      }\r\n    };\r\n\r\n    const handleTouchEnd = () => {\r\n      fireSyntheticDrag('end', 'down', 0, 'touch');\r\n    };\r\n\r\n    const handleWheel = (e: WheelEvent) => {\r\n      if (!attachedEl) return;\r\n      const { deltaY } = e;\r\n      const top = atTop(attachedEl);\r\n      const bottom = atBottom(attachedEl);\r\n      if ((deltaY < 0 && top) || (deltaY > 0 && bottom)) {\r\n        fireSyntheticDrag('move', deltaY > 0 ? 'down' : 'up', Math.min(600, Math.abs(deltaY)), 'wheel');\r\n      }\r\n    };\r\n\r\n    const cleanupFrom = (el: HTMLElement | null) => {\r\n      if (!el) return;\r\n      el.removeEventListener('touchstart', handleTouchStart as any);\r\n      el.removeEventListener('touchmove', handleTouchMove as any);\r\n      el.removeEventListener('touchend', handleTouchEnd as any);\r\n      el.removeEventListener('wheel', handleWheel as any);\r\n    };\r\n\r\n    const maybeAttach = () => {\r\n      const el = document.querySelector('.embedded-app') as HTMLElement | null;\r\n      if (!el || el === attachedEl) return;\r\n      cleanupFrom(attachedEl);\r\n      attachedEl = el;\r\n      attachedEl.addEventListener('touchstart', handleTouchStart, { passive: true });\r\n      attachedEl.addEventListener('touchmove', handleTouchMove, { passive: true });\r\n      attachedEl.addEventListener('touchend', handleTouchEnd, { passive: true });\r\n      attachedEl.addEventListener('wheel', handleWheel, { passive: true });\r\n    };\r\n\r\n    const mo = new MutationObserver(maybeAttach);\r\n    mo.observe(document.body, { childList: true, subtree: true });\r\n    maybeAttach();\r\n\r\n    return () => {\r\n      mo.disconnect();\r\n      cleanupFrom(attachedEl);\r\n      attachedEl = null;\r\n    };\r\n  }, [scrollContainerRef, focusedProjectKey]);\r\n\r\n  const blockIds = useMemo(() => projects.map(p => `#block-${p.key}`), [projects]);\r\n\r\n  useEffect(() => {\r\n    const cleanup = attachOpacityObserver(blockIds, focusedProjectKey);\r\n    return cleanup;\r\n  }, [blockIds, focusedProjectKey]);\r\n\r\n  // Example consumer  left in place to react to synthetic-drag if you want\r\n  useEffect(() => {\r\n    const el = scrollContainerRef.current;\r\n    if (!el) return;\r\n    const onSynthetic = (_e: Event) => {};\r\n    el.addEventListener('synthetic-drag', onSynthetic as EventListener);\r\n    return () => el.removeEventListener('synthetic-drag', onSynthetic as EventListener);\r\n  }, [scrollContainerRef]);\r\n\r\n  return (\r\n    <div\r\n      ref={scrollContainerRef}\r\n      className=\"SnappyScrollThingy\"\r\n      style={{\r\n        overflowY: 'scroll',\r\n        // STRONG snap whenever not focused; focus mode disables via inline/logic above.\r\n        scrollSnapType: focusedProjectKey ? 'none' : 'y mandatory',\r\n        scrollBehavior: 'smooth',\r\n        scrollbarWidth: 'none',\r\n        msOverflowStyle: 'none',\r\n      }}\r\n    >\r\n      <style>{`\r\n        .SnappyScrollThingy::-webkit-scrollbar { display: none; }\r\n        /* Allow native edge handoff */\r\n        .SnappyScrollThingy { overscroll-behavior: auto; }\r\n        .embedded-app { touch-action: pan-y; overscroll-behavior: auto; }\r\n\r\n        /* Snap control helpers */\r\n        .SnappyScrollThingy.no-snap { scroll-snap-type: none !important; }\r\n        .SnappyScrollThingy.snap-proximity { scroll-snap-type: y proximity !important; }\r\n      `}</style>\r\n\r\n      {projects.map((item, idx) => {\r\n        const isFocused = focusedProjectKey === item.key;\r\n        return (\r\n          <ProjectPane\r\n            key={item.key}\r\n            item={item}\r\n            isFocused={isFocused}\r\n            isFirst={idx === 0}\r\n            setRef={(el) => { projectRefs.current[item.key] = el; }}\r\n          />\r\n        );\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ScrollController;\r\n","// title-context.tsx\r\nimport React, { createContext, useContext, useState } from 'react';\r\n\r\nexport const TitleContext = createContext<{\r\n  activeTitle: string;\r\n  setActiveTitle: (t: string) => void;\r\n}>({ activeTitle: '', setActiveTitle: () => {} });\r\n\r\nexport const TitleProvider = ({ children }) => {\r\n  const [activeTitle, setActiveTitle] = useState('');\r\n  return (\r\n    <TitleContext.Provider value={{ activeTitle, setActiveTitle }}>\r\n      {children}\r\n    </TitleContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useActiveTitle = () => useContext(TitleContext);\r\n","import { useEffect, useRef } from 'react';\r\nimport { baseProjects } from '../content-utility/component-loader';\r\nimport { useActiveTitle } from './title-context';\r\nimport { useSsrData } from '../context-providers/ssr-data-context';\r\nimport { seededShuffle } from '../seed';\r\nimport { useProjectVisibility } from '../context-providers/project-context';\r\n\r\nconst TitleObserver = () => {\r\n  const { setActiveTitle } = useActiveTitle();\r\n  const { focusedProjectKey } = useProjectVisibility();\r\n  const { seed = 12345 } = useSsrData() || {};\r\n\r\n  // Stable order for this session\r\n  const projectsRef = useRef(seededShuffle(baseProjects, seed));\r\n  const lastTitleRef = useRef<string | null>(null);\r\n  const observerRef = useRef<IntersectionObserver | null>(null);\r\n  const moRef = useRef<MutationObserver | null>(null);\r\n\r\n  // Helper: pick the element whose center is closest to viewport center\r\n  const pickCenteredNow = () => {\r\n    // While focused, never mutate the title from visibility.\r\n    if (focusedProjectKey) return;\r\n\r\n    const vh = window.innerHeight || document.documentElement.clientHeight || 0;\r\n    const viewportCenter = vh * 0.5;\r\n\r\n    let bestTitle: string | null = null;\r\n    let bestDist = Infinity;\r\n\r\n    for (const p of projectsRef.current) {\r\n      const el = document.getElementById(`block-${p.key}`);\r\n      if (!el || el.style.display === 'none') continue;\r\n\r\n      const r = el.getBoundingClientRect();\r\n      if (r.bottom <= 0 || r.top >= vh) continue;\r\n\r\n      const center = r.top + r.height / 2;\r\n      const dist = Math.abs(center - viewportCenter);\r\n      if (dist < bestDist) {\r\n        bestDist = dist;\r\n        bestTitle = p.title;\r\n      }\r\n    }\r\n\r\n    if (bestTitle && bestTitle !== lastTitleRef.current) {\r\n      lastTitleRef.current = bestTitle;\r\n      setActiveTitle(bestTitle);\r\n    }\r\n  };\r\n\r\n  // Build observer once\r\n  useEffect(() => {\r\n    const io = new IntersectionObserver(\r\n      () => {\r\n        if (focusedProjectKey) return; // ignore while focused\r\n        requestAnimationFrame(pickCenteredNow);\r\n      },\r\n      { threshold: [0, 0.25, 0.5, 0.75, 1] }\r\n    );\r\n    observerRef.current = io;\r\n\r\n    // Observe all blocks that exist (will keep observing through display:none)\r\n    for (const p of projectsRef.current) {\r\n      const el = document.getElementById(`block-${p.key}`);\r\n      if (el) io.observe(el);\r\n    }\r\n\r\n    // Also react to late-mounted blocks\r\n    const mo = new MutationObserver(() => {\r\n      const cur = observerRef.current;\r\n      if (!cur) return;\r\n      for (const p of projectsRef.current) {\r\n        const el = document.getElementById(`block-${p.key}`);\r\n        if (el) cur.observe(el);\r\n      }\r\n    });\r\n    mo.observe(document.body, { childList: true, subtree: true });\r\n    moRef.current = mo;\r\n\r\n    // Initial pick\r\n    requestAnimationFrame(pickCenteredNow);\r\n\r\n    return () => {\r\n      io.disconnect();\r\n      mo.disconnect();\r\n      observerRef.current = null;\r\n      moRef.current = null;\r\n    };\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, []); // once per mount\r\n\r\n  // NEW: Freeze title on focus & pause the observer; resume on unfocus\r\n  useEffect(() => {\r\n    const io = observerRef.current;\r\n\r\n    if (focusedProjectKey) {\r\n      // 1) Set title to the focused project's title exactly once on enter\r\n      const focused = projectsRef.current.find(p => p.key === focusedProjectKey);\r\n      if (focused && focused.title !== lastTitleRef.current) {\r\n        lastTitleRef.current = focused.title;\r\n        setActiveTitle(focused.title);\r\n      }\r\n      // 2) Pause the observer work during focus\r\n      io?.disconnect();\r\n    } else {\r\n      // Resubscribe and immediately pick based on visibility when leaving focus\r\n      if (io) {\r\n        for (const p of projectsRef.current) {\r\n          const el = document.getElementById(`block-${p.key}`);\r\n          if (el) io.observe(el);\r\n        }\r\n      }\r\n      requestAnimationFrame(pickCenteredNow);\r\n    }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [focusedProjectKey, setActiveTitle]);\r\n\r\n  return null;\r\n};\r\n\r\nexport default TitleObserver;\r\n","// src/utils/title/view-project.tsx\r\nimport React, { useEffect, useRef, useState, useMemo } from 'react';\r\nimport lottie from '../../utils/load-lottie';\r\nimport arrowData from '../../svg/arrow.json';\r\nimport linkData from '../../svg/link.json';\r\n\r\nimport { useActiveTitle } from './title-context';\r\nimport { baseProjects } from '../content-utility/component-loader';\r\nimport { projectColors } from '../content-utility/color-map';\r\nimport { useSsrData } from '../context-providers/ssr-data-context';\r\nimport { seededShuffle } from '../seed';\r\n\r\nimport TitleObserver from './title-observer';\r\nimport { useProjectVisibility } from '../context-providers/project-context';\r\n\r\n// Minimal shape for what we use from Lottie\r\ntype AnimationItemLike = {\r\n  goToAndStop: (value: number, isFrame?: boolean) => void;\r\n  playSegments: (segments: [number, number] | number[], forceFlag?: boolean) => void;\r\n  addEventListener: (name: string, cb: () => void) => void;\r\n  removeEventListener: (name: string, cb: () => void) => void;\r\n  destroy: () => void;\r\n};\r\n\r\nconst ViewProject = () => {\r\n  const { activeTitle } = useActiveTitle();\r\n  const { seed = 12345 } = useSsrData() || {};\r\n  const projects = useMemo(() => seededShuffle(baseProjects, seed), [seed]);\r\n\r\n  // Focus state shared across app\r\n  const { focusedProjectKey, setFocusedProjectKey } = useProjectVisibility();\r\n\r\n  const focusedProject = useMemo(\r\n    () => projects.find(p => p.key === focusedProjectKey!),\r\n    [projects, focusedProjectKey]\r\n  );\r\n\r\n  // Freeze the title (and everything derived from it) when focused\r\n  const displayTitle = focusedProjectKey ? (focusedProject?.title ?? activeTitle) : activeTitle;\r\n\r\n  const arrowContainer = useRef<HTMLDivElement>(null);\r\n  const arrowAnimRef = useRef<AnimationItemLike | null>(null);\r\n  const lastTitleRef = useRef(displayTitle);\r\n\r\n  const [hovered, setHovered] = useState(false);\r\n  const [showBackground, setShowBackground] = useState(true);\r\n  const hideTimeoutRef = useRef<ReturnType<typeof setTimeout> | null>(null);\r\n\r\n  const currentProject = useMemo(\r\n    () => projects.find((p) => p.title === displayTitle),\r\n    [projects, displayTitle]\r\n  );\r\n  const isLink = currentProject?.isLink;\r\n  const currentKey = currentProject?.key;\r\n\r\n  const getBackgroundColor = () => {\r\n    const colorInfo = projectColors[displayTitle];\r\n    if (!colorInfo) return 'rgba(240, 240, 240, 0.5)';\r\n    const alpha = hovered ? 1 : (colorInfo.defaultAlpha ?? 0.8);\r\n    return `rgba(${colorInfo.rgb}, ${alpha})`;\r\n  };\r\n\r\n  const triggerBackgroundFade = () => {\r\n    setShowBackground(true);\r\n    if (hideTimeoutRef.current) clearTimeout(hideTimeoutRef.current);\r\n    hideTimeoutRef.current = setTimeout(() => setShowBackground(false), 1500);\r\n  };\r\n\r\n  // (Re)create arrow/link Lottie when the *displayed* title changes\r\n  useEffect(() => {\r\n    const el = arrowContainer.current;\r\n    if (!el) return;\r\n\r\n    let anim: AnimationItemLike | null = null;\r\n    let mounted = true;\r\n\r\n    (async () => {\r\n      const animationData = displayTitle === 'Dynamic App' ? linkData : arrowData;\r\n\r\n      anim = await lottie.loadAnimation({\r\n        container: el,\r\n        renderer: 'svg',\r\n        loop: false,\r\n        autoplay: false,\r\n        animationData,\r\n      });\r\n\r\n      if (!mounted || !anim) return;\r\n\r\n      arrowAnimRef.current = anim;\r\n      anim.goToAndStop(40, true);\r\n\r\n      const onDomLoaded = () => {\r\n        const svg = el.querySelector('svg');\r\n        if (svg) svg.classList.add('arrow-svg');\r\n      };\r\n\r\n      anim.addEventListener('DOMLoaded', onDomLoaded);\r\n\r\n      return () => {\r\n        anim?.removeEventListener('DOMLoaded', onDomLoaded);\r\n      };\r\n    })();\r\n\r\n    return () => {\r\n      mounted = false;\r\n      arrowAnimRef.current?.destroy();\r\n      arrowAnimRef.current = null;\r\n    };\r\n  }, [displayTitle]);\r\n\r\n  // Play a segment when the *displayed* title actually changes\r\n  useEffect(() => {\r\n    if (lastTitleRef.current !== displayTitle) {\r\n      arrowAnimRef.current?.playSegments([40, 90], true);\r\n      lastTitleRef.current = displayTitle;\r\n      triggerBackgroundFade();\r\n    }\r\n  }, [displayTitle]);\r\n\r\n  // Trigger background fade on user motion (bottom ~35% of viewport) or touch\r\n  useEffect(() => {\r\n    const handleMouseMove = (e: MouseEvent) => {\r\n      const viewportH = window.innerHeight || document.documentElement.clientHeight;\r\n      if (e.clientY >= viewportH * 0.65) triggerBackgroundFade();\r\n    };\r\n    const handleTouch = () => triggerBackgroundFade();\r\n\r\n    window.addEventListener('mousemove', handleMouseMove);\r\n    window.addEventListener('touchstart', handleTouch, { passive: true });\r\n    window.addEventListener('touchmove', handleTouch, { passive: true });\r\n\r\n    return () => {\r\n      window.removeEventListener('mousemove', handleMouseMove);\r\n      window.removeEventListener('touchstart', handleTouch);\r\n      window.removeEventListener('touchmove', handleTouch);\r\n      if (hideTimeoutRef.current) clearTimeout(hideTimeoutRef.current);\r\n    };\r\n  }, []);\r\n\r\n  // Toggle the focused project key; ScrollController reacts to this\r\n  const handleToggleOpen = () => {\r\n    if (!currentKey) return;\r\n    const next = focusedProjectKey === currentKey ? null : currentKey;\r\n    setFocusedProjectKey(next);\r\n\r\n    if (next) {\r\n      requestAnimationFrame(() => {\r\n        const el = document.getElementById(`block-${next}`);\r\n        el?.scrollIntoView({ block: 'start', behavior: 'smooth' });\r\n      });\r\n    }\r\n  };\r\n\r\n  const Element: any = isLink ? 'a' : 'button';\r\n  const sharedProps = {\r\n    className: `view-project-btn ${!showBackground ? 'no-bg' : ''}`,\r\n    onMouseEnter: () => setHovered(true),\r\n    onMouseLeave: () => setHovered(false),\r\n    'data-project-key': currentKey ?? undefined,\r\n    'aria-pressed': currentKey ? focusedProjectKey === currentKey : undefined,\r\n    ...(isLink\r\n      ? { href: '/dynamic-theme', target: '_blank', rel: 'noopener noreferrer' }\r\n      : { onClick: handleToggleOpen }\r\n    ),\r\n  };\r\n\r\n  return (\r\n    <div className=\"view-project-wrapper\">\r\n      {/* Dont observe while focused, so title stays frozen */}\r\n      {!focusedProjectKey && <TitleObserver />}\r\n\r\n      <Element {...sharedProps}>\r\n        <div\r\n          className={`view-project-background ${!showBackground ? 'no-bg' : ''}`}\r\n          style={{\r\n            backgroundColor: getBackgroundColor(),\r\n            position: 'absolute',\r\n            inset: 0,\r\n            borderRadius: 'inherit',\r\n            zIndex: 0,\r\n          }}\r\n        />\r\n        <h2 className=\"project-view\" style={{ position: 'relative', zIndex: 1 }}>\r\n          {displayTitle}\r\n        </h2>\r\n        <div\r\n          ref={arrowContainer}\r\n          className=\"view-project-arrow\"\r\n          style={{ position: 'relative', zIndex: 1 }}\r\n        />\r\n      </Element>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ViewProject;\r\n"],"names":["useEffect","loadable","ViewProject","TitleProvider","ScrollController","ProjectVisibilityProvider","jsx","_jsx","jsxs","_jsxs","NavMenu","resolved","chunkName","isReady","props","key","resolve","__webpack_modules__","importAsync","requireAsync","then","requireSync","id","__webpack_require__","eval","require","resolveWeak","ssr","fallback","Frontpage","root","document","getElementById","requestAnimationFrame","removeAttribute","isAllowZoomTarget","ev","el","target","closest","Boolean","preventPinchZoom","event","tag","tagName","toLowerCase","touches","length","preventDefault","preventGesture","e","addEventListener","passive","removeEventListener","children","className","style","position","loadFocusedDetails","projectColors","rgb","tooltipAlpha","defaultAlpha","darkThemeTop","useRef","useState","Fragment","_Fragment","EventMount","load","active","componentProps","fadeMs","Comp","setComp","visible","setVisible","loadingRef","current","mod","default","alive","opacity","transition","undefined","willChange","Suspense","hasWindow","window","hasRIC","hasCIC","ric","cb","opts","requestIdleCallback","setTimeout","timeout","cic","cancelIdleCallback","clearTimeout","LazyInView","serverRender","eager","allowIdle","observeTargetId","rootMargin","threshold","placeholderMinHeight","debugLabel","isServer","initialVisible","isVisible","setIsVisible","Component","setComponent","selfRef","idleId","IntersectionObserver","io","entry","vis","isIntersecting","ratio","intersectionRatio","console","log","disconnect","observe","cancelled","content","ref","width","height","minHeight","lazy","LazyViewMount","mountMode","enterThreshold","exitThreshold","unmountDelayMs","preloadOnIdle","preloadIdleTimeout","preloadOnFirstIO","fadeEasing","mountedRef","isMounted","setIsMounted","unmountTimer","fadeTimer","preloadPromiseRef","lastRatio","lastIntersecting","firstIOSeen","ensurePreloaded","clearTimers","mountNow","p","prev","unmountSoon","enter","Math","max","min","exit","thresholds","Array","from","Set","sort","a","b","intersecting","crossedEnter","crossedExit","becameIntersecting","leftIntersecting","CompAny","attachOpacityObserver","ids","focusedProjectKey","isRealMobile","coarse","matchMedia","matches","touch","navigator","maxTouchPoints","vv","visualViewport","shrinks","gap","innerHeight","baseMin","focusedId","observed","WeakSet","observer","entries","mapped","String","_","i","observeTargets","forEach","sel","querySelector","has","add","mo","MutationObserver","body","childList","subtree","React","createContext","useContext","ProjectVisibilityContext","activeProject","setActiveProject","blockGClick","setBlockGClick","currentIndex","setCurrentIndex","isDragging","setIsDragging","setFocusedProjectKey","previousScrollY","setPreviousScrollY","scrollContainerRef","alignFnRef","requestViewportAlign","useCallback","args","registerViewportAlign","fn","Provider","value","useProjectVisibility","context","Error","LoadingScreen","useProjectLoader","useSsrData","ssrRegistry","ProjectPane","item","isFocused","setRef","isFirst","payload","preloaded","desc","hasSSR","render","isHydrated","setIsHydrated","data","isDynamic","isGame","usesCustomLoader","fallbackNode","isFullScreen","blockId","rootRef","EXIT_DELAY_MS","activeDelayed","setActiveDelayed","exitTimerRef","ResizeObserver","ro","h","offsetHeight","setProperty","scrollSnapAlign","scrollSnapStop","contentVisibility","containIntrinsicSize","contain","overflow","title","useMemo","baseProjects","seededShuffle","seed","projectsRef","projects","projectRefs","lastScrollTopRef","lastScrollDirRef","VIS_RATIO_TO_EXIT","VIS_DWELL_MS","MAX_UNLOCK_VH","MIN_LINGER_MS","MAX_LINGER_MS","SNAP_RAMP_MS","SNAP_KB_FALLBACK_MS","UNLOCK_FALLBACK_MS","lastFocusedKeyRef","exitTargetKeyRef","getOffsetTopWithin","scroller","r1","getBoundingClientRect","r2","top","st","scrollTop","documentElement","container","classList","remove","scrollingElement","targetEl","getViewportH","clientHeight","scrollIntoView","block","behavior","bump","round","scrollBy","left","setScrollTop","scrollTo","hardPlaceAtKey","targetTop","prevBehavior","scrollBehavior","prevOverflow","overflowY","animatePlaceToKey","ms","startTop","delta","abs","reduce","duration","start","performance","now","easeOutCubic","t","pow","raf","step","y","cancelAnimationFrame","dwellTimer","pendingKey","focusedIdx","findIndex","clampAdjacentKey","dir","nextIdx","pickCandidate","vh","viewportCenter","bestKey","bestDist","Infinity","r","bottom","center","dist","onTick","curr","anyVisibleOther","neighbor","onScroll","preferredKey","dispatchEvent","CustomEvent","detail","cancelTween","oldKey","oldEl","prevH","unlockTimer","ramp","cleanupFns","push","postTimer","scrollContainer","attachedEl","atTop","atBottom","EPS","ceil","devicePixelRatio","scrollHeight","fireSyntheticDrag","phase","direction","magnitude","source","velocity","evt","ts","bubbles","composed","lastY","lastTs","handleTouchStart","clientY","handleTouchMove","dy","dt","handleTouchEnd","handleWheel","deltaY","cleanupFrom","maybeAttach","blockIds","map","cleanup","onSynthetic","_e","scrollSnapType","scrollbarWidth","msOverflowStyle","idx","TitleContext","activeTitle","setActiveTitle","useActiveTitle","TitleObserver","lastTitleRef","observerRef","moRef","pickCenteredNow","bestTitle","display","cur","focused","find","lottie","arrowData","linkData","focusedProject","displayTitle","arrowContainer","arrowAnimRef","hovered","setHovered","showBackground","setShowBackground","hideTimeoutRef","currentProject","isLink","currentKey","getBackgroundColor","colorInfo","alpha","triggerBackgroundFade","anim","mounted","animationData","loadAnimation","renderer","loop","autoplay","goToAndStop","onDomLoaded","svg","destroy","playSegments","handleMouseMove","viewportH","handleTouch","handleToggleOpen","next","Element","sharedProps","onMouseEnter","onMouseLeave","href","rel","onClick","backgroundColor","inset","borderRadius","zIndex"],"sourceRoot":""}