"use strict";exports.id=775,exports.ids=[775],exports.modules={1775:(t,e,i)=>{i.r(e),i.d(e,{default:()=>h});var s=i(2015),n=i(6506),r=i(6442);function h({onCoinsChange:t,highScore:e=0,onGameOver:h,onReady:o,pauseWhenHidden:a=!0,demoMode:l=!1,overlayActive:c=!1,allowSpawns:d=!0}){const p=(0,s.useRef)(null),u=(0,s.useRef)(null),y=(0,s.useRef)(!0),v=(0,s.useRef)(null),x=(0,s.useRef)(t),f=(0,s.useRef)(h),m=(0,s.useRef)(o),g=(0,s.useRef)(e),w=(0,s.useRef)(a),z=(0,s.useRef)(!!l),M=(0,s.useRef)(!!c),R=(0,s.useRef)(d);x.current=t,f.current=h,m.current=o,g.current=e,w.current=a,z.current=!!l,M.current=!!c,R.current=!!d;const O=(0,n.e)();return(0,s.useEffect)(()=>{let t=!0,e=null,s=null;return Promise.resolve().then(i.t.bind(i,7902,23)).then(i=>{if(!t)return;const n=i.default??i,r=p.current;if(!r||!r.isConnected)return;if(r.replaceChildren(),u.current?.remove){try{u.current.remove()}catch{}u.current=null}const h=t=>{let e,i=!1,s=[],n=[],h=[],o=[],a=0,l=0,c=2,d=0,p=!1,v=!1,k=!0,C=-1/0;const L=1500,S=O?600:1200,E=140;let D=null,I=null,W=null,b=null;const A=new Map,_=O?.5:.35;let H=!1,N=!1,T=!1,G=!1,P=[];const q={x:0,y:0};function F(){return z.current||R.current}const U=()=>{p=!1,d=0,x.current?.(d),s.length=0,n.length=0,h.length=0,o.length=0,e=new B(t,240,t.height/2,33),u.current.circle=e,l=t.millis()};function V(t,e,i){for(let s=0;s<8;s++){const n=t.TWO_PI/8*s,r=t.random(2,4),h=Math.cos(n)*r,a=Math.sin(n)*r;o.push(new J(t,e,i,h,a,"#c896ff"))}o.length>E&&o.splice(0,o.length-E)}t.restartGame=U,t.setup=()=>{const s=r.offsetWidth,n=r.offsetHeight;O&&t.pixelDensity&&t.pixelDensity(1),t.frameRate?.(60),t.createCanvas(s,n),r.style.touchAction="none",t.canvas.style.touchAction="none",r.style.overscrollBehavior="none",r.style.webkitUserSelect="none",r.style.userSelect="none";const h=t.canvas,a=e=>{const i=h.getBoundingClientRect();return q.x=(e.clientX-i.left)*(t.width/i.width),q.y=(e.clientY-i.top)*(t.height/i.height),q},c=e=>{if(z.current||M.current)return;const{x:i,y:s}=a(e);null===D&&null===W?(W=e.pointerId,b={x0:i,y0:s,x:i,y:s,t0:t.millis()}):A.set(e.pointerId,{x0:i,y0:s,x:i,y:s,t0:t.millis()}),e.preventDefault()},d=t=>{if(z.current||M.current)return;const{x:i,y:s}=a(t);if(W===t.pointerId&&null===D){b&&(b.x=i,b.y=s);const e=i-(b?.x0??i),n=s-(b?.y0??s);return Math.hypot(e,n)>12&&(((t,e,i)=>{D=t,I={x:e,y:i};try{h.setPointerCapture(t)}catch{}})(t.pointerId,i,s),W=null,b=null),void t.preventDefault()}if(t.pointerId===D){if(!I||!e)return I={x:i,y:s},void t.preventDefault();const n=i-I.x,r=s-I.y,h=Math.hypot(n,r)||1,o=Math.log2(h+1),a=_*o;return e.vx+=n/h*a,e.vy+=r/h*a,I={x:i,y:s},void t.preventDefault()}const n=A.get(t.pointerId);n&&(n.x=i,n.y=s),t.preventDefault()},p=()=>{const i=t.millis();if(i-C>=L){C=i;const s=0!==e.vx||0!==e.vy?e.vx:5,n=0!==e.vy||0!==e.vx?e.vy:0;o.push(new j(t,e.x,e.y,s,n)),o.length>E&&o.splice(0,o.length-E)}},y=e=>{if(z.current||M.current)return;if(e.pointerId===D){try{h.releasePointerCapture(e.pointerId)}catch{}return D=null,I=null,void e.preventDefault()}if(W===e.pointerId&&null===D){const i=b;if(W=null,b=null,i){const e=t.millis()-i.t0,s=Math.hypot(i.x-i.x0,i.y-i.y0);e<=180&&s<=12&&p()}return void e.preventDefault()}const i=A.get(e.pointerId);if(i){A.delete(e.pointerId);const s=t.millis()-i.t0,n=Math.hypot(i.x-i.x0,i.y-i.y0);s<=180&&n<=12&&p(),e.preventDefault()}},v=t=>{t.pointerId===D&&(D=null,I=null),W===t.pointerId&&(W=null,b=null),A.delete(t.pointerId)};h.addEventListener("pointerdown",c,{passive:!1}),h.addEventListener("pointermove",d,{passive:!1}),h.addEventListener("pointerup",y,{passive:!1}),h.addEventListener("pointercancel",v,{passive:!1}),h.addEventListener("lostpointercapture",t=>{t.pointerId===D&&(D=null,I=null)}),t._pointerCleanup=()=>{try{h.removeEventListener("pointerdown",c),h.removeEventListener("pointermove",d),h.removeEventListener("pointerup",y),h.removeEventListener("pointercancel",v)}catch{}},i=window.innerWidth<=1024&&window.innerHeight>window.innerWidth,P=[t.color(255,215,0),t.color(255,223,70),t.color(255,200,0),t.color(255,170,50)],l=t.millis(),e=new B(t,240,n/2,33),u.current.circle=e,m.current?.({restart:U})},t.draw=()=>{const r=z.current;if(!r&&k){s.length=0,n.length=0,h.length=0,o.length=0,d=0,x.current?.(0),e.x=240,e.y=t.height/2,e.vx=e.vy=e.ax=e.ay=0;const i=t.millis();l=i,a=i}if(k=r,w.current&&!y.current)return void t.background(28);const u=t.deltaTime/16.67,m=t.millis(),E=t.width,D=t.height;t.background(28),!r&&M.current&&(H=N=T=G=!1,e.stopHorizontal(),e.stopVertical()),r?function(){let i=0,r=0,h=0;for(const t of s){const s=t.x+t.w/2,n=t.y+t.h/2,o=e.x-s,a=e.y-n,l=o*o+a*a;if(l<2e4){const t=Math.sqrt(l)||1,e=1/(t+300)*150;i+=o/t*e,r+=a/t*e,h+=1/(t+1)*10}}let o=0,a=0;if(n.length>0&&h<50){const t=n.reduce((t,i)=>{const s=Math.hypot(e.x-(t.x+t.size/2),e.y-(t.y+t.size/2));return Math.hypot(e.x-(i.x+i.size/2),e.y-(i.y+i.size/2))<s?i:t}),i=t.x+t.size/2-e.x,s=t.y+t.size/2-e.y,r=Math.hypot(i,s)||1;o=i/r*.45,a=s/r*.45}if(e.ax=i+o,e.ay=r+a,0===e.ax&&0===e.ay){const i=t.width/2-e.x,s=t.height/2-e.y,n=Math.hypot(i,s)||1;e.ax=i/n*.1,e.ay=s/n*.1}}():(H?e.moveUp():N?e.moveDown():e.stopVertical(),T?e.moveLeft():G?e.moveRight():e.stopHorizontal()),e.update(u,E,D),e.display(t),function(t,e,n,r){if(!R.current)return;if(!F())return;const h=s.filter(t=>i?t.y+t.h>0&&t.y<r:t.x+t.w>0&&t.x<n).length;let o;const l=window.innerWidth;window.innerHeight,l>=1025?(o=50,c=h<10?6:h<25?5:h<40?4:0):l>=768?(o=60,c=h<8?5:h<20?4:h<40?3:0):(o=25,c=h<10?4:h<20?3:1),c>0&&e-a>2e3/c&&h<o&&(s.push(new Y(t,!0,!1,i,P)),a=e),s.length>220&&s.splice(0,s.length-220),e%5e3<20&&(s=s.filter(t=>!isNaN(t.x)&&!isNaN(t.y)))}(t,m,E,D),function(t,n,r,h,a){for(let r=s.length-1;r>=0;r--){const l=s[r];l.update(n),l.display(t),!z.current&&e.overlaps(l)&&(p=!0);for(let e=o.length-1;e>=0;e--){const i=o[e],h=i.size??2*i.radius,a=i.x-(i.size?i.size/2:i.radius),c=i.y-(i.size?i.size/2:i.radius),d=h;if(a+h>l.x&&a<l.x+l.w&&c+d>l.y&&c<l.y+l.h){i instanceof J?t.random()<.05?(s.splice(r,1),o.splice(e,1),V(t,l.x+l.w/2,l.y+l.h/2)):(i.vx*=-1,i.vy*=-1,i.x+=i.vx*n*2,i.y+=i.vy*n*2):(s.splice(r,1),o.splice(e,1),V(t,l.x+l.w/2,l.y+l.h/2));break}}(i?l.y-l.h>a+100||l.y+l.h<-100:l.x+l.w<-100||l.x-l.w>h+100)&&s.splice(r,1)}for(let t=0;t<s.length;t++){const e=s[t];for(let i=t+1;i<s.length;i++){const t=s[i];e.overlaps(t)&&e.resolveCollision(t)}}}(t,u,0,E,D),function(t,e){R.current&&F()&&e-l>2e3&&(0===n.length&&n.push(new Y(t,!0,!0,i,P)),l=e)}(t,m),function(t,i,s,r){const o=150;for(let a=n.length-1;a>=0;a--){const l=n[a];if(l.update(i),l.display(t),e.overlaps(l)){z.current||(d+=20,x.current?.(d));for(let e=0;e<10;e++)h.push(new X(t,l.x+l.size/2,l.y+l.size/2,255,l.c,0,0,5));h.length>S&&h.splice(0,h.length-S),n.splice(a,1);continue}const c=Math.abs(l.vx)+Math.abs(l.vy);let p;p=c<1?.05:c<3?.1:c<6?.2:.3;const u=Math.floor(p),y=p-u;for(let e=0;e<u;e++)h.push(new X(t,l.x+l.size/2,l.y+l.size/2,255,l.c));t.random()<y&&h.push(new X(t,l.x+l.size/2,l.y+l.size/2,255,l.c)),h.length>S&&h.splice(0,h.length-S),(l.x+l.size<-150||l.x-l.size>s+o||l.y+l.size<-150||l.y-l.size>r+o)&&n.splice(a,1)}}(t,u,E,D),O||t.blendMode(t.ADD);for(let e=h.length-1;e>=0;e--){const i=h[e];i.update(u),i.display(t),i.isDead()&&h.splice(e,1)}O||t.blendMode(t.BLEND);for(let e=o.length-1;e>=0;e--){const i=o[e];i.update(u,E,D),i.display(t),i.isDead(E,D)&&o.splice(e,1)}if(r)p=!1;else{if(!v&&p){const t=d>(g.current??0);f.current?.(d,t)}if(v=p,p)return void t.background(28,180);!function(t,i){const s=i-C;if(s>=L)return;const n=48*(1-s/L);t.noStroke(),t.fill(200,150,255,100),t.ellipse(e.x,e.y,2*n,2*n)}(t,m)}},t.keyPressed=()=>{if(!z.current&&!M.current){if(" "===t.key||"Spacebar"===t.key){const i=t.millis();if(i-C>=L&&(C=i,e)){const i=0!==e.vx||0!==e.vy?e.vx:5,s=0!==e.vy||0!==e.vx?e.vy:0;o.push(new j(t,e.x,e.y,i,s)),o.length>E&&o.splice(0,o.length-E)}}"w"!==t.key&&t.keyCode!==t.UP_ARROW||(H=!0),"s"!==t.key&&t.keyCode!==t.DOWN_ARROW||(N=!0),"a"!==t.key&&t.keyCode!==t.LEFT_ARROW||(T=!0),"d"!==t.key&&t.keyCode!==t.RIGHT_ARROW||(G=!0)}},t.keyReleased=()=>{z.current||M.current||("w"!==t.key&&t.keyCode!==t.UP_ARROW||(H=!1),"s"!==t.key&&t.keyCode!==t.DOWN_ARROW||(N=!1),"a"!==t.key&&t.keyCode!==t.LEFT_ARROW||(T=!1),"d"!==t.key&&t.keyCode!==t.RIGHT_ARROW||(G=!1))};class B{constructor(t,e,i,s){this.p=t,this.x=e,this.y=i,this.vx=0,this.vy=0,this.ax=0,this.ay=0,this.radius=s,this.c=t.color(200,150,255),this.trail=[]}update(t,e,i){this.vx+=this.ax*t,this.vy+=this.ay*t;const s=Math.pow(.92,t);this.vx*=s,this.vy*=s,this.x+=this.vx*t,this.y+=this.vy*t,this.y+this.radius<0?this.y=i+this.radius:this.y-this.radius>i&&(this.y=-this.radius),this.x+this.radius<0?this.x=e+this.radius:this.x-this.radius>e&&(this.x=-this.radius),this.trail.push({x:this.x,y:this.y}),this.trail.length>8&&this.trail.shift();this.vx<-10?this.vx=-10:this.vx>10&&(this.vx=10),this.vy<-10?this.vy=-10:this.vy>10&&(this.vy=10)}display(t){const e=this.trail.length;for(let i=0;i<e;i++){const s=this.trail[i],n=t.map(i,0,e-1,30,100),r=t.map(i,0,e-1,this.radius/2,this.radius);t.fill(200,150,255,n),t.noStroke(),t.ellipse(s.x,s.y,r,r)}t.fill(this.c),t.noStroke(),t.ellipse(this.x,this.y,this.radius,this.radius)}moveUp(){this.ay=-.5}moveDown(){this.ay=.5}moveLeft(){this.ax=-.5}moveRight(){this.ax=.5}stopVertical(){this.ay=0}stopHorizontal(){this.ax=0}overlaps(t){if(t.isOctagon){const e=this.x-(t.x+t.size/2),i=this.y-(t.y+t.size/2),s=this.radius+t.size/2;return e*e+i*i<s*s}const e=Math.max(t.x,Math.min(this.x,t.x+t.w)),i=Math.max(t.y,Math.min(this.y,t.y+t.h)),s=this.x-e,n=this.y-i,r=.3*this.radius;return s*s+n*n<r*r}}class Y{x=0;y=0;vx=0;vy=0;w=0;h=0;size=0;rotation=0;rotationSpeed=0;constructor(t,e,i,s,n){this.p=t,this.isOctagon=i,this.verticalMode=s,this.GOLD=n,this.reset(e)}reset(t){const e=window.innerWidth,i=window.innerHeight;if(this.verticalMode)this.x=this.p.random(this.p.width),this.isOctagon?(this.y=t?-this.p.random(30,60):this.p.random(this.p.height),this.vx=this.p.random(-1.2,1.2),this.p.random()<.1?this.vy=this.p.random(6,9):this.p.random()<.2?this.vy=this.p.random(.5,1.5):this.vy=this.p.random(2,5),this.size=25,this.c=this.p.random(this.GOLD)):(this.y=t?-this.p.random(60,120):this.p.random(this.p.height),this.vx=this.p.random(-.5,.5),this.vy=this.p.random(1,3),this.w=this.p.random(28,70),this.h=this.p.random(28,70),this.c=this.p.color(235,235,255));else if(this.x=t?this.p.width+this.p.random(10,40):this.p.random(this.p.width),this.y=this.p.random(this.p.height),this.isOctagon){let t=this.p.random(-2.5,-.5);e>=1025&&e>i&&(t*=4.5),this.p.random()<.1?t*=2:this.p.random()<.2&&(t*=.5),this.vx=t,this.vy=this.p.random(-.3,.3),this.size=25,this.c=this.p.random(this.GOLD)}else this.vx=this.p.random(-3,-1),this.vy=this.p.random(-.5,.5),e>=1025&&e>i?(this.w=this.p.random(33,105),this.h=this.p.random(33,105)):(this.w=this.p.random(30,75),this.h=this.p.random(30,75)),this.c=this.p.color(235,235,255);this.rotation=0,this.rotationSpeed=this.p.random(-1,1)}update(t){this.x+=this.vx*t,this.y+=this.vy*t,this.rotation+=this.rotationSpeed*t}display(t){t.push(),t.translate(this.x+(this.isOctagon?this.size/2:this.w/2),this.y+(this.isOctagon?this.size/2:this.h/2)),t.rotate(t.radians(this.rotation)),t.fill(this.c),t.noStroke(),this.isOctagon?this.drawOctagon(t,0,0,this.size):(t.rectMode(t.CENTER),t.rect(0,0,this.w,this.h)),t.pop()}drawOctagon(t,e,i,s){const n=t.TWO_PI/8;t.beginShape();for(let r=0;r<8;r++){const h=r*n,o=e+Math.cos(h)*s/2,a=i+Math.sin(h)*s/2;t.vertex(o,a)}t.endShape(t.CLOSE)}overlaps(t){const e=this.isOctagon?this.size:this.w,i=this.isOctagon?this.size:this.h,s=t.isOctagon?t.size:t.w,n=t.isOctagon?t.size:t.h;return!(this.x+e<t.x||this.x>t.x+s||this.y+i<t.y||this.y>t.y+n)}resolveCollision(t){const e=this.isOctagon?this.size:this.w,i=this.isOctagon?this.size:this.h,s=t.isOctagon?t.size:t.w,n=t.isOctagon?t.size:t.h,r=Math.min(this.x+e,t.x+s)-Math.max(this.x,t.x),h=Math.min(this.y+i,t.y+n)-Math.max(this.y,t.y);r<h?(this.x<t.x?(this.x-=r/2,t.x+=r/2):(this.x+=r/2,t.x-=r/2),this.vx*=-1,t.vx*=-1):(this.y<t.y?(this.y-=h/2,t.y+=h/2):(this.y+=h/2,t.y-=h/2),this.vy*=-1,t.vy*=-1)}}class X{constructor(t,e,i,s=255,n=t.color(255,215,0),r=0,h=0,o=null){this.p=t,this.x=e,this.y=i,this.lifespan=s,this.c=n;const a=Math.hypot(r,h);let l=t.map(a,0,5,1,3);l=t.constrain(l,1.2,3.5),null!=o&&(l*=o);const c=t.random(0,t.TWO_PI);this.vx=Math.cos(c)*l+.1*r,this.vy=Math.sin(c)*l+.1*h}update(t){this.x+=this.vx*t,this.y+=this.vy*t,this.lifespan-=1*t}display(t){t.noStroke(),t.fill(this.c.levels[0],this.c.levels[1],this.c.levels[2],this.lifespan),t.ellipse(this.x,this.y,4,4)}isDead(){return this.lifespan<=0}}class j{minSpeed=.6;maxSpeed=12;speed=this.minSpeed;targetSpeed=8;acceleration=3;constructor(t,e,i,s,n){this.p=t,this.x=e,this.y=i;const r=Math.hypot(s,n)||1;this.ux=s/r,this.uy=n/r,this.vx=this.ux*this.speed,this.vy=this.uy*this.speed,this.radius=6,this.lifespan=500,this.trail=[],this.color=t.color(200,150,255)}update(t){this.speed+=(this.targetSpeed-this.speed)*this.acceleration*t,this.speed<this.minSpeed&&(this.speed=this.minSpeed),this.speed>this.maxSpeed&&(this.speed=this.maxSpeed),this.vx=this.ux*this.speed,this.vy=this.uy*this.speed,this.x+=this.vx*t,this.y+=this.vy*t,this.lifespan-=1*t,this.trail.push({x:this.x,y:this.y,alpha:160}),this.trail.length>20&&this.trail.shift();for(let t=0;t<this.trail.length;t++)this.trail[t].alpha*=.8}display(t){for(let e=0;e<this.trail.length;e++){const i=this.trail[e];t.fill(200,150,255,i.alpha),t.noStroke(),t.ellipse(i.x,i.y,2*this.radius,2*this.radius)}t.fill(this.color),t.noStroke(),t.ellipse(this.x,this.y,2*this.radius,2*this.radius)}isDead(t,e){return this.lifespan<=0||this.x<0||this.x>t||this.y<0||this.y>e}}class J{constructor(t,e,i,s,n,r){this.p=t,this.x=e,this.y=i,this.size=t.random(8,20);const h=this.p.map(this.size,8,20,1,2);this.vx=s*h,this.vy=n*h,this.lifespan=80,this.maxLifespan=this.lifespan,this.color=t.color(r),this.rotation=t.random(360),this.rotationSpeed=t.random(-20,20)}update(t){this.x+=this.vx*t,this.y+=this.vy*t,this.lifespan-=1*t,this.rotation+=this.rotationSpeed*t}display(t){t.push(),t.translate(this.x,this.y),t.rotate(t.radians(this.rotation));const e=t.map(this.lifespan,0,this.maxLifespan,0,255);t.fill(this.color.levels[0],this.color.levels[1],this.color.levels[2],e),t.noStroke(),t.rectMode(t.CENTER),t.rect(0,0,this.size,this.size),t.pop()}isDead(t,e){return this.lifespan<=0||this.x<-50||this.x>t+50||this.y<-50||this.y>e+50}}};requestAnimationFrame(()=>{if(!t||!r.isConnected)return;if(u.current){try{u.current.remove?.()}catch{}u.current=null}let i;try{i=new n(h,r)}catch(t){return void console.error("[GameCanvas] q5 init error",t)}u.current=i,w.current&&"IntersectionObserver"in window&&(e=new IntersectionObserver(([t])=>{y.current=t.isIntersecting;try{t.isIntersecting?u.current?.loop?.():u.current?.noLoop?.()}catch{}},{threshold:.01}),e.observe(r));let o=null;const a=window.visualViewport;let l=0,c=0;const d=()=>{const t=p.current,e=u.current;if(!t||!t.isConnected||!e?.resizeCanvas)return;const i=Math.max(1,Math.round(t.offsetWidth)),s=Math.max(1,Math.round(t.offsetHeight));if(i!==l||s!==c){l=i,c=s;try{e.resizeCanvas(i,s)}catch(t){console.warn("[GameCanvas] resize skipped",t)}}};s=()=>requestAnimationFrame(d),window.addEventListener("resize",s),"ResizeObserver"in window&&(o=new ResizeObserver(()=>requestAnimationFrame(d)),o.observe(r)),window.addEventListener("orientationchange",s),a?.addEventListener("resize",s),a?.addEventListener("scroll",s);const x=()=>requestAnimationFrame(d);document.addEventListener("fullscreenchange",x),requestAnimationFrame(d),v.current=()=>{const t=u.current;if(t&&"function"==typeof t._pointerCleanup)try{t._pointerCleanup()}catch{}e&&e.disconnect(),s&&window.removeEventListener("resize",s),document.removeEventListener("fullscreenchange",x),o?.disconnect(),a?.removeEventListener("resize",s),a?.removeEventListener("scroll",s),u.current?.remove&&u.current.remove(),u.current=null,r.replaceChildren()}})}),()=>{t=!1,v.current?.(),v.current=null}},[]),(0,r.Y)("div",{className:"evade-the-rock",ref:p,style:{width:"100vw",height:"100dvh"}})}}};
//# sourceMappingURL=775.server.js.map