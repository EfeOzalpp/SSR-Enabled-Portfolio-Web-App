"use strict";exports.id=131,exports.ids=[131],exports.modules={3131:(t,e,i)=>{i.r(e),i.d(e,{default:()=>h});var r=i(2015),s=i(7902),a=i.n(s),o=i(6506),n=i(6442);const h=({colorMapping:t={},items:e=[],lastKnownColor:i,onToggleFireworks:s})=>{const h=(0,r.useRef)(null),[l,d]=(0,r.useState)(!0),c=(0,r.useRef)([]),m=(0,r.useRef)(!0),p=(0,r.useRef)(!1),f=(0,r.useRef)(0),u=(0,r.useRef)(0),w=(0,o.e)(),g=(0,r.useRef)(w);(0,r.useEffect)(()=>{g.current=w},[w]),(0,r.useEffect)(()=>{const t=()=>{if("hidden"===document.visibilityState)p.current=!0,f.current=performance.now();else if("visible"===document.visibilityState){p.current=!1;const t=performance.now();u.current+=t-f.current}};return document.addEventListener("visibilitychange",t),()=>{document.removeEventListener("visibilitychange",t)}},[]);const v=(0,r.useRef)(null),y=(0,r.useRef)(e),I=(0,r.useRef)(t),k=(0,r.useRef)(i);(0,r.useEffect)(()=>{y.current=e,I.current=t,k.current=i},[e,t,i]),(0,r.useEffect)(()=>{let t=!1;if(h.current&&!v.current&&!t)return v.current=new(a())(t=>{let e=c.current,i=-8e3,r=t.createVector(t.width/2,t.height);class s{constructor(e,i,r,s,a,o,n=!1){let h,l;this.pos=t.createVector(e,i),this.vel=s?t.createVector(0,t.random(-10,-20)):t.createVector(t.random(-1,1),t.random(-1,1)).mult(t.random(0,18)),this.acc=t.createVector(0,0),this.col=this.adjustBrightness(r,a>10?t.random(1.4,2):a>5?t.random(1.1,1.3):t.random(.7,1.1)),this.firework=s,this.size=a,this.type=o,this.hasTrail=n,this.shapeType=t.random(["circle","square","triangle"]),t.windowWidth<768?(h=t.random(30,60),l=t.random(40,80)):t.windowWidth<=1024?(h=t.random(50,80),l=t.random(70,100)):(h=t.random(50,90),l=t.random(80,140)),this.lifespan=t.map(a,1,12,h,l),this.trailLength=a>=4&&a<=12?8:1,this.trail=Array(this.trailLength).fill(t.createVector(e,i));const d=this.vel.mag();this.trailLifespan=Array(this.trailLength).fill(t.map(d,0,20,0,100)),this.fadeFactor=t.map(a,1,15,.6,.5),this.blinkingSpeed=s?0:t.random(5,30),this.blinkingAlpha=255}adjustBrightness(e,i){const r=Math.min(255,Math.max(0,e.levels[0]*i)),s=Math.min(255,Math.max(0,e.levels[1]*i)),a=Math.min(255,Math.max(0,e.levels[2]*i));return t.color(r,s,a)}applyForce(t){this.acc.add(t)}update(){if(this.vel.add(this.acc),this.pos.add(this.vel),this.acc.mult(0),!this.firework){if(this.vel.mult(.927),this.lifespan-=this.fadeFactor,this.lifespan<=0&&(this.lifespan=0),this.hasTrail){this.trail.pop(),this.trail.unshift(this.pos.copy());for(let t=0;t<this.trailLifespan.length;t++)this.trailLifespan[t]-=this.fadeFactor,this.trailLifespan[t]=Math.max(0,this.trailLifespan[t])}let e;this.size>=1&&this.size<2?e=t.random(-.151,-.161):this.size>=2&&this.size<3?e=t.random(-.146,-.156):this.size>=3&&this.size<4?e=t.random(-.144,-.145):this.size>=4&&this.size<5?e=t.random(-.141,-.143):this.size>=5&&this.size<6?e=t.random(-.139,-.14):this.size>=6&&this.size<7?e=t.random(-.137,-.138):this.size>=7&&this.size<8?e=t.random(-.135,-.136):this.size>=8&&this.size<9?e=t.random(-.134,-.136):this.size<=9?e=t.random(-.135,-.137):this.size>=10&&this.size<=12&&(e=t.random(-.094,-.137)),this.applyForce(t.createVector(0,e))}this.firework||"BLINKING"!==this.type||(this.blinkingAlpha=Math.abs(255*Math.sin(t.millis()/1e3*this.blinkingSpeed)))}show(){let e=this.firework?t.map(this.lifespan,0,255,0,255):"BLINKING"===this.type?this.blinkingAlpha:t.map(this.lifespan,0,255,0,255);t.noStroke();let i=this.size;if(!this.firework){const e=t.map(this.lifespan,255,0,0,5)<=2?1:t.map(this.lifespan,255,0,1,0);i=this.size*(1-Math.pow(1-e,6))}const r=Math.max(1.1*i,1),s=t.atan2(this.vel.y,this.vel.x);if(this.hasTrail)for(let e=0;e<this.trail.length;e++){const i=this.trailLifespan[e];if(i>0){const r=this.firework?.9*this.size:.8*this.size;t.strokeWeight(r),t.stroke(this.col.levels[0],this.col.levels[1],this.col.levels[2],i),t.point(this.trail[e].x,this.trail[e].y)}}t.push(),t.translate(this.pos.x,this.pos.y),t.rotate(s);const a=.01*this.vel.mag();if(t.rotate(t.frameCount*a),t.fill(this.col.levels[0],this.col.levels[1],this.col.levels[2],e),"circle"===this.shapeType)t.ellipse(0,0,r,r);else if("square"===this.shapeType){const e=r/2;t.rect(-e,-e,r,r)}else if("triangle"===this.shapeType){const e=r/2;t.triangle(0,-e,-e,e,e,e)}t.pop()}isDone(){return this.lifespan<=0}}class a{constructor(e,i,r,a,o,n){let h;this.firework=new s(e,i,o,!0,4,n),this.particles=[],this.exploded=!1,this.targetX=r,t.windowWidth<768?(this.targetX=t.random(.5*t.width,.9*t.width),this.targetY=t.random(.1*t.height,.3*t.height)):t.windowWidth>=768&&t.windowWidth<=1024?(this.targetX=t.random(.65*t.width,.9*t.width),this.targetY=t.random(.05*t.height,.3*t.height)):(this.targetX=t.random(.3*t.width,.7*t.width),this.targetY=t.random(.05*t.height,.4*t.height)),this.col=o,this.type=n,this.explosionStartTime=-1,h=t.windowWidth<768?"BLINKING"===n?t.random(150,275):t.random(125,225):t.windowWidth<=1024?"BLINKING"===n?t.random(275,325):t.random(200,250):"BLINKING"===n?t.random(250,300):t.random(300,350),this.numParticles=Math.floor(h)}explode(){let e=this.firework.vel.copy();const i="PROJECTILE"===this.type?Math.floor(t.random(25,50)):0;for(let r=0;r<this.numParticles;r++){let a;a="PROJECTILE"===this.type&&r<i?t.random(10,12):"BLINKING"===this.type?t.random(1,9):t.random(1,8);let o="BLINKING"===this.type?(()=>{let e;return e=a>=1&&a<2?t.random(.5,2.7):a>=2&&a<3?t.random(2.5,4.7):a>=3&&a<4?t.random(4.5,6.7):a>=4&&a<5?t.random(6.5,8.7):a>=5&&a<6?t.random(8.5,8.7):a>=6&&a<7?t.random(8.8,9):a>=7&&a<8?t.random(9.1,9.2):a>=8&&a<9?t.random(9.2,9.3):t.random(9.4,9.5),n(e)})():(()=>{let e;return e=a>=1&&a<7?t.random(1,9):a>=7&&a<9?t.random(8,9):a>=10&&a<12?t.random(9,9.2):t.random(1,4),n(e)})();function n(e){let i=t.windowWidth,r=1;return i<768?r=t.random(1.8,2.6):i>=768&&i<=1024?r=t.random(1.6,2.2):i>1024&&(r=t.random(1.2,2.2)),e*r}let h=t.random(t.TWO_PI),l=t.createVector(t.cos(h),t.sin(h)).mult(o),d=Math.abs(t.atan2(l.y,l.x)-t.atan2(e.y,e.x))<t.HALF_PI/4?t.random(0,.5):t.random(.5,.8);l.add(e.mult(d));let c=a>6,m="BLINKING",p=new s(this.firework.pos.x+t.random(-2,6),this.firework.pos.y+t.random(-2,6),this.col,!1,a,m,c);p.vel=l,this.particles.push(p)}this.exploded=!0,this.explosionStartTime=t.millis()}update(){if(!this.exploded){let e,i=t.createVector(this.targetX-this.firework.pos.x,this.targetY-this.firework.pos.y);i.normalize(),e=t.windowWidth<768?t.random(6,11):t.windowWidth<=1024?t.random(5,9):t.random(3,8),i.mult(e),this.firework.vel=i,this.firework.update(),t.dist(this.firework.pos.x,this.firework.pos.y,this.targetX,this.targetY)<10&&this.explode()}for(let e=this.particles.length-1;e>=0;e--){let i=this.particles[e];i.applyForce(t.createVector(0,.16)),i.update(),i.isDone()&&this.particles.splice(e,1)}}show(){this.exploded||this.firework.show();for(let t of this.particles)t.show()}}function o(i){const s=t.width/2,o=t.height,n=y.current?.[0]?.alt1||"",h=I.current[n]||[];if(!h.length)return void console.warn(`No colors available for alt1: '${n}'`);let l;l=t.windowWidth>=1025?3:t.windowWidth>=768?2:1;const d=[h[0],h[1],h[3]].filter(Boolean);if(0===d.length)return;const c=function(t,e){let i=parseInt(t.slice(1,3),16),r=parseInt(t.slice(3,5),16),s=parseInt(t.slice(5,7),16);return i=Math.min(255,Math.max(0,Math.floor(i*e))),r=Math.min(255,Math.max(0,Math.floor(r*e))),s=Math.min(255,Math.max(0,Math.floor(s*e))),`#${i.toString(16).padStart(2,"0")}${r.toString(16).padStart(2,"0")}${s.toString(16).padStart(2,"0")}`}(d[Math.floor(t.random(d.length))],t.random(1,1.4)),m=t.color(c),p=t.width/2+t.random(-50,50),f="BLINKING"===i?.2*t.height:.7*t.height;r=t.createVector(p,f),e.push(new a(s,o,p,f,m,i))}t.setup=()=>{t.createCanvas(t.windowWidth,t.windowHeight),o(Math.random()<.5?"BLINKING":"PROJECTILE"),i=t.millis()},u.current=0,i=0;let n=!0,h=t.random(3e3,7e3);t.draw=()=>{if(g.current?t.clear():t.background("#1e1e1f"),!m.current)return void(c.current.length=0);for(let t of e)t.update(),t.show();const r=t.millis()-u.current;r<i&&(console.warn("Adjusted time went backward or stale. Forcing firework reset."),i=r-h-1),r-i>h&&(o(n?"BLINKING":"PROJECTILE"),n=!n,i=r,h=t.random(2e3,8e3))}},h.current),()=>{t=!0,v.current&&(v.current.remove(),v.current=null),c.current=[]}},[]);const x=(0,r.useCallback)(t=>{d(t),m.current=t},[]);return(0,r.useEffect)(()=>{s&&s(x)},[s,x]),(0,n.Y)("div",{ref:h})}}};
//# sourceMappingURL=131.server.js.map