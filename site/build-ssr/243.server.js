"use strict";exports.id=243,exports.ids=[243,690],exports.modules={243:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var o=n(2015),i=n(3292),r=n(1643),a=n(5093),s=n(533),l=n(394),d=n(5991),c=n(6442);function u(){const e=(0,l.A)(),[t,n]=(0,o.useState)(e?.preloaded?.dataviz||null);if((0,s.h)(),(0,o.useEffect)(()=>{t||i.default.fetch('*[_type == "mediaBlock" && slug.current == $slug][0]{\n          mediaOne{\n            alt,\n            image,\n            video{\n              "webmUrl": webm.asset->url,\n              "mp4Url": mp4.asset->url,\n              poster\n            }\n          }\n        }',{slug:"data-viz"}).then(n).catch(e=>{console.warn("[DataVisualizationBlock] GROQ fetch failed:",e),n(null)})},[]),!t?.mediaOne)return null;const{alt:u="Data Visualization",image:m,video:p}=t.mediaOne,v=Boolean(p?.webmUrl||p?.mp4Url),h=p?.poster?(0,d.Kn)(p.poster,1920,1080,90):void 0;return(0,c.Y)("section",{className:"block-type-1",style:{position:"relative",width:"100%",height:"100dvh",overflow:"hidden"},children:(0,c.Y)("div",{className:"media-content",style:{width:"100%",height:"100%",position:"absolute",inset:0},children:(0,c.Y)(a.A,{sensitivity:2,children:(0,c.Y)(r.A,{type:v?"video":"image",src:v?p:m,alt:u,id:v?"dataviz-media-video":"dataviz-media",...h?{"data-src-full":h}:{},className:"tooltip-data-viz",objectPosition:"center center",style:{width:"100%",height:"100%"}})})})})}},533:(e,t,n)=>{n.d(t,{h:()=>f});var o=n(2015),i=n(5067);const r={},a={"block-g":["#q5.js Canvas","#Gamification","#Lottie Animation"]},s={"rotary-lamp":"Rotary Lamp","ice-scoop":"Ice Cream Scoop","data-viz":"Data Visualization","block-g":"Evade the Rock",dynamic:"Dynamic App"};let l=null,d="",c=null;const u=()=>{l&&(c&&clearTimeout(c),l.style.opacity="1",l.style.visibility="visible",c=setTimeout(()=>m(),1500))},m=()=>{l&&(c&&clearTimeout(c),l.style.opacity="0",l.style.visibility="hidden",d="")};function p(e,t){if(!l)return;const n=l.getBoundingClientRect(),o=window.innerWidth,i=window.innerHeight,r=t<n.height+0+20,a=t+n.height+0>i-20,s=e+n.width+0>o-20,d=e<n.width+0+20;let c,u;a?(u=t-n.height-0-8,c=e-0*n.width):r?(u=t+0-14,c=e-0*n.width):s?(u=t-n.height/2,c=e-n.width-0-24):d?(u=t-n.height/2,c=e+0-4):(u=t-n.height/1.6,c=e+0-2),c=Math.max(0,Math.min(c,o-n.width-0)),u=Math.max(0,Math.min(u,i-n.height-0)),l.style.left=`${c}px`,l.style.top=`${u}px`}function v(e){if(l)return()=>{};l=function(){const e=document.createElement("div");return e.id="custom-global-tooltip",e.style.position="fixed",e.style.pointerEvents="none",e.style.zIndex="9999",e.style.opacity="0",e.style.visibility="hidden",e.style.backdropFilter="blur(8px)",e.style.color="#fff",e.style.transition="opacity 0.3s ease, visibility 0.3s ease",e.className="custom-tooltip-blur",(document.getElementById("efe-portfolio")||document.body).appendChild(e),e}();let t=-1,o=-1,v=!1,h=null;const f=async e=>{if(!(e instanceof HTMLElement))return void m();const t=[...e.classList].find(e=>e.startsWith("tooltip-"));if(!t)return void m();const o=t.replace("tooltip-","");if(o!==d){d=o;const e=await(async e=>{if(r[e])return r[e];const t=function(e){const t=i.s[s[e]],n=t?.tooltipAlpha??.6;return t?`rgba(${t.rgb}, ${n})`:"rgba(85,95,90,0.6)"}(e);if(a[e]){const n={tags:a[e],backgroundColor:t};return r[e]=n,n}try{const o=(await Promise.resolve().then(n.bind(n,3292))).default,i=await o.fetch('*[_type=="mediaBlock" && slug.current == $key][0]{ tags }',{key:e}),a={tags:i?.tags??[],backgroundColor:t};return r[e]=a,a}catch{const n={tags:[],backgroundColor:t};return r[e]=n,n}})(o);if(!e.tags.length)return void m();l.innerHTML=e.tags.map(e=>`<p class="tooltip-tag">${e}</p>`).join(""),l.style.backgroundColor=e.backgroundColor,u()}else"0"!==l.style.opacity&&"hidden"!==l.style.visibility||u()},y=e=>{t=e.clientX,o=e.clientY,requestAnimationFrame(()=>p(t,o)),f(e.target)},g=()=>{v||(window.requestAnimationFrame(()=>{(()=>{const e=document.elementFromPoint(t,o);f(e),requestAnimationFrame(()=>p(t,o))})(),v=!1}),v=!0),h&&clearTimeout(h),h=setTimeout(()=>{},120)},w=e=>{e.relatedTarget||m()};return e||window.addEventListener("scroll",g,!0),document.addEventListener("mousemove",y,{passive:!0}),document.addEventListener("mouseout",w,{passive:!0}),()=>{l&&(e||window.removeEventListener("scroll",g,!0),document.removeEventListener("mousemove",y),document.removeEventListener("mouseout",w),l.remove(),l=null,c&&clearTimeout(c))}}var h=n(6506);const f=()=>{const e=(0,h.e)();(0,o.useEffect)(()=>{const t=v(e);return()=>t?.()},[e])}},1643:(e,t,n)=>{n.d(t,{A:()=>u});var o=n(2015),i=n(4274),r=n(5991);let a=0,s=0,l=[],d=null;var c=n(6442);const u=({type:e,src:t,alt:n="",id:u,className:m="",style:p={},objectPosition:v="center center",loop:h=!0,muted:f=!0,playsInline:y=!0,preload:g="metadata",enableVisibilityControl:w=!0,priority:b=!1,controls:E=!1})=>{const L="undefined"==typeof window,[T,A]=(0,o.useState)(L),[k,S]=(0,o.useState)(!1),[U,x]=(0,o.useState)(!1),[C,z]=(0,o.useState)(!1),F=(0,o.useRef)(null),I=(0,o.useRef)(null),M=(0,o.useRef)(null),Y=function(e,{rootMargin:t="900px 0px",threshold:n=0,once:i=!0}={}){const[r,a]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{if(!e.current||r)return;const o=new IntersectionObserver(e=>{e.some(e=>e.isIntersecting)&&(a(!0),i&&o.disconnect())},{rootMargin:t,threshold:n});return o.observe(e.current),()=>o.disconnect()},[e,r,t,n,i]),r}(M),D=b||Y;(0,o.useEffect)(()=>{"image"===e&&I.current?.complete&&A(!0),"video"===e&&F.current?.readyState>=2&&A(!0)},[e]),(0,o.useEffect)(()=>{if("image"!==e)return;a++,((e=5e3)=>{d||(d=setTimeout(()=>{l.forEach(e=>e()),l=[]},e))})();const t=setTimeout(()=>S(!0),D?0:2e3);var n;D&&S(!0),n=()=>setTimeout(()=>x(!0),300),l.push(n);const o=setTimeout(()=>x(!0),5e3);return()=>{clearTimeout(t),clearTimeout(o)}},[e,D]);const P=()=>{if(A(!0),"image"===e&&(s++,s>=a&&(l.forEach(e=>e()),l=[])),u){const e=new CustomEvent("mediaReady",{detail:{id:u}});window.dispatchEvent(e)}},R="object"==typeof t&&null!==t&&!("asset"in t)&&("webmUrl"in t||"mp4Url"in t),V=R?t:void 0,j="string"==typeof t?t:void 0,B=V?.poster?"string"==typeof V.poster?V.poster:(0,r.dk)(V.poster).width(1200).quality(80).auto("format").url():void 0;(0,o.useEffect)(()=>{if("video"!==e||!F.current)return;const t=F.current,n=()=>{z(!0),t.removeAttribute("poster")},o=()=>{const e=t;if("function"!=typeof e.requestVideoFrameCallback){const e=()=>{t.currentTime>0&&t.readyState>=2&&(t.removeEventListener("timeupdate",e),n())};t.addEventListener("timeupdate",e);const o=setTimeout(()=>{t.removeEventListener("timeupdate",e),n()},1200);return()=>clearTimeout(o)}e.requestVideoFrameCallback(()=>n())};return t.addEventListener("play",o,{once:!0}),()=>t.removeEventListener("play",o)},[e]),((e,t,n=.4)=>{(0,o.useEffect)(()=>{if(!e?.current||!t?.current)return;const o="number"==typeof n&&n>=0&&n<=1?n:.4;let i;const r=e.current,a=t.current;r.load(),r.muted=!0,i=new IntersectionObserver(([e])=>{e.isIntersecting?r.play().catch(()=>setTimeout(()=>r.play().catch(()=>{}),500)):r.pause()},{threshold:o}),i.observe(a);const s=a.getBoundingClientRect();return Math.min(Math.max((window.innerHeight-s.top)/window.innerHeight,0),1)>=o&&r.play().catch(()=>{}),()=>i?.disconnect()},[e,t,n])})(F,M,"video"===e&&w?.35:void 0),(0,o.useEffect)(()=>{if("video"!==e||!F.current)return;const t=F.current;let n=null,o=null;const i=()=>{try{t.preload=g??"metadata","none"!==t.preload&&t.load()}catch{}},r=async()=>{if(w)try{t.muted&&t.playsInline&&t.paused&&t.readyState>=2&&await t.play().catch(()=>{})}catch{}},a=()=>{A(!0),(()=>{try{if(t.readyState<2)return;const e=t.currentTime;t.currentTime=e>0?e:.001}catch{}})()},s=()=>{A(!0),r()},l=()=>{A(!0),r()};D&&(i(),n=window.setTimeout(()=>{t.readyState<2&&i()},2500),o=window.setTimeout(()=>{if(t.readyState<2)try{t.preload="auto",t.load()}catch{}},5e3)),t.addEventListener("loadedmetadata",a),t.addEventListener("loadeddata",s),t.addEventListener("canplay",l);const d=e=>console.warn("Video error",e),c=()=>console.warn("Video stalled"),u=()=>{};return t.addEventListener("error",d),t.addEventListener("stalled",c),t.addEventListener("suspend",u),()=>{n&&(window.clearTimeout(n),n=null),o&&(window.clearTimeout(o),o=null),t.removeEventListener("loadedmetadata",a),t.removeEventListener("loadeddata",s),t.removeEventListener("canplay",l),t.removeEventListener("error",d),t.removeEventListener("stalled",c),t.removeEventListener("suspend",u)}},[e,D,g,w,R,V&&V.webmUrl||"",V&&V.mp4Url||"",j||""]);const N=Boolean(V?.webmUrl||V?.mp4Url||j);if(!t||"video"===e&&!N)return null;if("image"===e){const e="string"==typeof t?t:(0,r.DB)(t),o="string"==typeof t?t:(0,r.oA)(t),a="string"==typeof t?t:(0,r.Kn)(t),s=U?a:k?o:e;return s?(0,c.FD)("div",{ref:M,style:{position:"relative",width:"100%",height:"100%"},children:[!T&&(0,c.Y)("div",{className:"absolute-inset",children:(0,c.Y)(i.A,{isFullScreen:!1})}),(0,c.Y)("img",{ref:I,loading:b?"eager":void 0,fetchPriority:U||b?"high":k?"auto":"low",id:u,src:s||void 0,alt:n,onLoad:P,onError:e=>console.warn("Image failed",e.target.src),className:m,draggable:!1,style:{...p,objectFit:"cover",objectPosition:v,opacity:T?1:0,transition:L?"none":"filter 0.5s ease, opacity 0.3s ease"}})]}):null}const q=!T;return(0,c.FD)("div",{ref:M,style:{position:"relative",width:"100%",height:"100%"},children:[q&&(0,c.Y)("div",{className:"absolute-inset",children:(0,c.Y)(i.A,{isFullScreen:!1})}),(0,c.FD)("video",{id:u,ref:F,onLoadedData:P,onLoadedMetadata:()=>A(!0),onError:e=>console.warn("Video failed",e),className:m,style:{...p,objectFit:"cover",objectPosition:v,opacity:T?1:0,transition:L?"none":"opacity 0.3s ease",pointerEvents:"all",zIndex:1},loop:h,muted:f,playsInline:y,preload:g??"metadata",controls:E,poster:C?void 0:B,children:[V?.mp4Url&&(0,c.Y)("source",{src:V.mp4Url||void 0,type:"video/mp4"}),V?.webmUrl&&(0,c.Y)("source",{src:V.webmUrl||void 0,type:"video/webm"}),!V?.webmUrl&&!V?.mp4Url&&j&&(0,c.Y)("source",{src:j||void 0})]})]})}},5067:(e,t,n)=>{n.d(t,{s:()=>o});const o={"Rotary Lamp":{rgb:"204, 85, 41",tooltipAlpha:.6,defaultAlpha:.6,darkThemeTop:"rgba(72, 161, 161, 1)"},"Ice Cream Scoop":{rgb:"234, 103, 97",tooltipAlpha:.6,defaultAlpha:.6,darkThemeTop:"rgba(23, 27, 24, 1)"},"Data Visualization":{rgb:"153, 199, 7",tooltipAlpha:.8,defaultAlpha:.6,darkThemeTop:"rgba(28, 30, 31, 1)"},"Evade the Rock":{rgb:"101, 86, 175",tooltipAlpha:.6,defaultAlpha:.6,darkThemeTop:"rgb(25, 25, 25)"},"Dynamic App":{rgb:"120, 211, 255",tooltipAlpha:.6,defaultAlpha:.6,darkThemeTop:"rgba(17, 17, 17, 1)"}}},6506:(e,t,n)=>{n.d(t,{e:()=>i});var o=n(2015);function i(){const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{const e=()=>{const e=navigator.maxTouchPoints>0,n=window.matchMedia?.("(pointer: coarse)").matches??!1,o=window.innerWidth,i=navigator.userAgent||navigator.vendor||window.opera,r=/iPad|iPhone|iPod/.test(i)||"MacIntel"===navigator.platform&&e,a=/Android/.test(i);t(e&&o<=1024||r||a||n)};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),e}}};
//# sourceMappingURL=243.server.js.map