"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[946],{53451:(e,t,n)=>{n.d(t,{e:()=>i});var o=n(31014);function i(){const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)(()=>{const e=()=>{var e,n,o;const i=navigator.maxTouchPoints>0,r=null!==(e=null===(n=(o=window).matchMedia)||void 0===n?void 0:n.call(o,"(pointer: coarse)").matches)&&void 0!==e&&e,a=window.innerWidth,s=navigator.userAgent||navigator.vendor||window.opera,l=/iPad|iPhone|iPod/.test(s)||"MacIntel"===navigator.platform&&i,d=/Android/.test(s);t(i&&a<=1024||l||d||r)};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}},[]),e}},67892:(e,t,n)=>{n.d(t,{A:()=>m});var o=n(89379),i=n(31014);var r=n(13721),a=n(93746);let s=0,l=0,d=[],c=null;const u=()=>{s++,function(){c||(c=setTimeout(()=>{d.forEach(e=>e()),d=[]},arguments.length>0&&void 0!==arguments[0]?arguments[0]:5e3))}()};var v=n(46550);const m=e=>{let{type:t,src:n,alt:c="",id:m,className:p="",style:h={},objectPosition:f="center center",loop:y=!0,muted:g=!0,playsInline:w=!0,preload:b="metadata",enableVisibilityControl:E=!0,priority:L=!1,controls:A=!1}=e;const x="undefined"===typeof window,[T,j]=(0,i.useState)(x),[k,S]=(0,i.useState)(!1),[U,C]=(0,i.useState)(!1),[_,z]=(0,i.useState)(!1),I=(0,i.useRef)(null),M=(0,i.useRef)(null),D=(0,i.useRef)(null),B=function(e){let{rootMargin:t="900px 0px",threshold:n=0,once:o=!0}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const[r,a]=(0,i.useState)(!1);return(0,i.useEffect)(()=>{if(!e.current||r)return;const i=new IntersectionObserver(e=>{e.some(e=>e.isIntersecting)&&(a(!0),o&&i.disconnect())},{rootMargin:t,threshold:n});return i.observe(e.current),()=>i.disconnect()},[e,r,t,n,o]),r}(D),F=L||B;(0,i.useEffect)(()=>{var e,n;"image"===t&&null!==(e=M.current)&&void 0!==e&&e.complete&&j(!0),"video"===t&&(null===(n=I.current)||void 0===n?void 0:n.readyState)>=2&&j(!0)},[t]),(0,i.useEffect)(()=>{if("image"!==t)return;u();const e=setTimeout(()=>S(!0),F?0:2e3);F&&S(!0);var n;n=()=>setTimeout(()=>C(!0),300),d.push(n);const o=setTimeout(()=>C(!0),5e3);return()=>{clearTimeout(e),clearTimeout(o)}},[t,F]);const N=()=>{if(j(!0),"image"===t&&(l++,l>=s&&(d.forEach(e=>e()),d=[])),m){const e=new CustomEvent("mediaReady",{detail:{id:m}});window.dispatchEvent(e)}},P="object"===typeof n&&null!==n&&!("asset"in n)&&("webmUrl"in n||"mp4Url"in n),O=P?n:void 0,R="string"===typeof n?n:void 0,V=null!==O&&void 0!==O&&O.poster?"string"===typeof O.poster?O.poster:(0,a.dk)(O.poster).width(1200).quality(80).auto("format").url():void 0;(0,i.useEffect)(()=>{if("video"!==t||!I.current)return;const e=I.current,n=()=>{z(!0),e.removeAttribute("poster")},o=()=>{const t=e;if("function"!==typeof t.requestVideoFrameCallback){const t=()=>{e.currentTime>0&&e.readyState>=2&&(e.removeEventListener("timeupdate",t),n())};e.addEventListener("timeupdate",t);const o=setTimeout(()=>{e.removeEventListener("timeupdate",t),n()},1200);return()=>clearTimeout(o)}t.requestVideoFrameCallback(()=>n())};return e.addEventListener("play",o,{once:!0}),()=>e.removeEventListener("play",o)},[t]),function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.4;(0,i.useEffect)(()=>{if(null===e||void 0===e||!e.current||null===t||void 0===t||!t.current)return;const o="number"===typeof n&&n>=0&&n<=1?n:.4;let i;const r=e.current,a=t.current;r.load(),r.muted=!0,i=new IntersectionObserver(e=>{let[t]=e;t.isIntersecting?r.play().catch(()=>setTimeout(()=>r.play().catch(()=>{}),500)):r.pause()},{threshold:o}),i.observe(a);const s=a.getBoundingClientRect();return Math.min(Math.max((window.innerHeight-s.top)/window.innerHeight,0),1)>=o&&r.play().catch(()=>{}),()=>{var e;return null===(e=i)||void 0===e?void 0:e.disconnect()}},[e,t,n])}(I,D,"video"===t&&E?.35:void 0),(0,i.useEffect)(()=>{if("video"!==t||!I.current)return;const e=I.current;let n=null,o=null;const i=()=>{try{e.preload=null!==b&&void 0!==b?b:"metadata","none"!==e.preload&&e.load()}catch(t){}},r=async()=>{if(E)try{e.muted&&e.playsInline&&e.paused&&e.readyState>=2&&await e.play().catch(()=>{})}catch(t){}},a=()=>{j(!0),(()=>{try{if(e.readyState<2)return;const t=e.currentTime;e.currentTime=t>0?t:.001}catch(t){}})()},s=()=>{j(!0),r()},l=()=>{j(!0),r()};F&&(i(),n=window.setTimeout(()=>{e.readyState<2&&i()},2500),o=window.setTimeout(()=>{if(e.readyState<2)try{e.preload="auto",e.load()}catch(t){}},5e3)),e.addEventListener("loadedmetadata",a),e.addEventListener("loadeddata",s),e.addEventListener("canplay",l);const d=e=>console.warn("Video error",e),c=()=>console.warn("Video stalled"),u=()=>{};return e.addEventListener("error",d),e.addEventListener("stalled",c),e.addEventListener("suspend",u),()=>{n&&(window.clearTimeout(n),n=null),o&&(window.clearTimeout(o),o=null),e.removeEventListener("loadedmetadata",a),e.removeEventListener("loadeddata",s),e.removeEventListener("canplay",l),e.removeEventListener("error",d),e.removeEventListener("stalled",c),e.removeEventListener("suspend",u)}},[t,F,b,E,P,O&&O.webmUrl||"",O&&O.mp4Url||"",R||""]);const q=Boolean((null===O||void 0===O?void 0:O.webmUrl)||(null===O||void 0===O?void 0:O.mp4Url)||R);if(!n||"video"===t&&!q)return null;if("image"===t){const e="string"===typeof n?n:(0,a.DB)(n),t="string"===typeof n?n:(0,a.oA)(n),i="string"===typeof n?n:(0,a.Kn)(n),s=U?i:k?t:e;return s?(0,v.jsxs)("div",{ref:D,style:{position:"relative",width:"100%",height:"100%"},children:[!T&&(0,v.jsx)("div",{className:"absolute-inset",children:(0,v.jsx)(r.A,{isFullScreen:!1})}),(0,v.jsx)("img",{ref:M,loading:L?"eager":void 0,fetchPriority:U||L?"high":k?"auto":"low",id:m,src:s||void 0,alt:c,onLoad:N,onError:e=>console.warn("Image failed",e.target.src),className:p,draggable:!1,style:(0,o.A)((0,o.A)({},h),{},{objectFit:"cover",objectPosition:f,opacity:T?1:0,transition:x?"none":"filter 0.5s ease, opacity 0.3s ease"})})]}):null}const H=!T;return(0,v.jsxs)("div",{ref:D,style:{position:"relative",width:"100%",height:"100%"},children:[H&&(0,v.jsx)("div",{className:"absolute-inset",children:(0,v.jsx)(r.A,{isFullScreen:!1})}),(0,v.jsxs)("video",{id:m,ref:I,onLoadedData:N,onLoadedMetadata:()=>j(!0),onError:e=>console.warn("Video failed",e),className:p,style:(0,o.A)((0,o.A)({},h),{},{objectFit:"cover",objectPosition:f,opacity:T?1:0,transition:x?"none":"opacity 0.3s ease",pointerEvents:"all",zIndex:1}),loop:y,muted:g,playsInline:w,preload:null!==b&&void 0!==b?b:"metadata",controls:A,poster:_?void 0:V,children:[(null===O||void 0===O?void 0:O.mp4Url)&&(0,v.jsx)("source",{src:O.mp4Url||void 0,type:"video/mp4"}),(null===O||void 0===O?void 0:O.webmUrl)&&(0,v.jsx)("source",{src:O.webmUrl||void 0,type:"video/webm"}),!(null!==O&&void 0!==O&&O.webmUrl)&&!(null!==O&&void 0!==O&&O.mp4Url)&&R&&(0,v.jsx)("source",{src:R||void 0})]})]})}},68493:(e,t,n)=>{n.d(t,{h:()=>y});var o=n(31014),i=n(21710);const r={},a={"block-g":["#q5.js Canvas","#Gamification","#Lottie Animation"]},s={"rotary-lamp":"Rotary Lamp","ice-scoop":"Ice Cream Scoop","data-viz":"Data Visualization","block-g":"Evade the Rock",dynamic:"Dynamic App"};let l=null,d="",c=null;const u=async e=>{if(r[e])return r[e];const t=function(e){var t;const n=i.s[s[e]],o=null!==(t=null===n||void 0===n?void 0:n.tooltipAlpha)&&void 0!==t?t:.6;return n?"rgba(".concat(n.rgb,", ").concat(o,")"):"rgba(85,95,90,0.6)"}(e);if(a[e]){const n={tags:a[e],backgroundColor:t};return r[e]=n,n}try{var o;const i=(await Promise.resolve().then(n.bind(n,78267))).default,a=await i.fetch('*[_type=="mediaBlock" && slug.current == $key][0]{ tags }',{key:e}),s={tags:null!==(o=null===a||void 0===a?void 0:a.tags)&&void 0!==o?o:[],backgroundColor:t};return r[e]=s,s}catch(l){const n={tags:[],backgroundColor:t};return r[e]=n,n}},v=()=>{l&&(c&&clearTimeout(c),l.style.opacity="1",l.style.visibility="visible",c=setTimeout(()=>m(),1500))},m=()=>{l&&(c&&clearTimeout(c),l.style.opacity="0",l.style.visibility="hidden",d="")};function p(e,t){if(!l)return;const n=l.getBoundingClientRect(),o=window.innerWidth,i=window.innerHeight,r=t<n.height+0+20,a=t+n.height+0>i-20,s=e+n.width+0>o-20,d=e<n.width+0+20;let c,u;a?(u=t-n.height-0-8,c=e-0*n.width):r?(u=t+0-14,c=e-0*n.width):s?(u=t-n.height/2,c=e-n.width-0-24):d?(u=t-n.height/2,c=e+0-4):(u=t-n.height/1.6,c=e+0-2),c=Math.max(0,Math.min(c,o-n.width-0)),u=Math.max(0,Math.min(u,i-n.height-0)),l.style.left="".concat(c,"px"),l.style.top="".concat(u,"px")}function h(e){if(l)return()=>{};l=function(){const e=document.createElement("div");return e.id="custom-global-tooltip",e.style.position="fixed",e.style.pointerEvents="none",e.style.zIndex="9999",e.style.opacity="0",e.style.visibility="hidden",e.style.backdropFilter="blur(8px)",e.style.color="#fff",e.style.transition="opacity 0.3s ease, visibility 0.3s ease",e.className="custom-tooltip-blur",(document.getElementById("efe-portfolio")||document.body).appendChild(e),e}();let t=-1,n=-1,o=!1,i=null;const r=async e=>{if(!(e instanceof HTMLElement))return void m();const t=[...e.classList].find(e=>e.startsWith("tooltip-"));if(!t)return void m();const n=t.replace("tooltip-","");if(n!==d){d=n;const e=await u(n);if(!e.tags.length)return void m();l.innerHTML=e.tags.map(e=>'<p class="tooltip-tag">'.concat(e,"</p>")).join(""),l.style.backgroundColor=e.backgroundColor,v()}else"0"!==l.style.opacity&&"hidden"!==l.style.visibility||v()},a=e=>{t=e.clientX,n=e.clientY,requestAnimationFrame(()=>p(t,n)),r(e.target)},s=()=>{o||(window.requestAnimationFrame(()=>{(()=>{const e=document.elementFromPoint(t,n);r(e),requestAnimationFrame(()=>p(t,n))})(),o=!1}),o=!0),i&&clearTimeout(i),i=setTimeout(()=>{},120)},h=e=>{e.relatedTarget||m()};return e||window.addEventListener("scroll",s,!0),document.addEventListener("mousemove",a,{passive:!0}),document.addEventListener("mouseout",h,{passive:!0}),()=>{l&&(e||window.removeEventListener("scroll",s,!0),document.removeEventListener("mousemove",a),document.removeEventListener("mouseout",h),l.remove(),l=null,c&&clearTimeout(c))}}var f=n(53451);const y=()=>{const e=(0,f.e)();(0,o.useEffect)(()=>{const t=h(e);return()=>null===t||void 0===t?void 0:t()},[e])}},93244:()=>{},99946:(e,t,n)=>{n.r(t),n.d(t,{default:()=>v});var o=n(89379),i=n(31014),r=n(78267),a=n(67892),s=n(13430),l=n(68493),d=n(58035),c=n(93746),u=(n(93244),n(46550));function v(){var e;const t=(0,d.A)(),[n,v]=(0,i.useState)((null===t||void 0===t||null===(e=t.preloaded)||void 0===e?void 0:e.dataviz)||null);if((0,l.h)(),(0,i.useEffect)(()=>{n||r.default.fetch('*[_type == "mediaBlock" && slug.current == $slug][0]{\n          mediaOne{\n            alt,\n            image,\n            video{\n              "webmUrl": webm.asset->url,\n              "mp4Url": mp4.asset->url,\n              poster\n            }\n          }\n        }',{slug:"data-viz"}).then(v).catch(e=>{console.warn("[DataVisualizationBlock] GROQ fetch failed:",e),v(null)})},[]),null===n||void 0===n||!n.mediaOne)return null;const{alt:m="Data Visualization",image:p,video:h}=n.mediaOne,f=Boolean((null===h||void 0===h?void 0:h.webmUrl)||(null===h||void 0===h?void 0:h.mp4Url)),y=null!==h&&void 0!==h&&h.poster?(0,c.Kn)(h.poster,1920,1080,90):void 0;return(0,u.jsx)("section",{className:"block-type-1",style:{position:"relative",width:"100%",height:"100dvh",overflow:"hidden"},children:(0,u.jsx)("div",{className:"media-content",style:{width:"100%",height:"100%",position:"absolute",inset:0},children:(0,u.jsx)(s.A,{sensitivity:2,children:(0,u.jsx)(a.A,(0,o.A)((0,o.A)({type:f?"video":"image",src:f?h:p,alt:m,id:f?"dataviz-media-video":"dataviz-media"},y?{"data-src-full":y}:{}),{},{className:"tooltip-data-viz",objectPosition:"center center",style:{width:"100%",height:"100%"}}))})})})}}}]);
//# sourceMappingURL=946.362cd743.chunk.js.map