{"version":3,"file":"static/js/dynamic-app-components-fireworksDisplay.58330378.chunk.js","mappings":"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","sources":["dynamic-app/components/fireworksDisplay.jsx","utils/content-utility/real-mobile.ts"],"sourcesContent":["// Firework Animation Code\r\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\r\nimport q5 from 'q5';\r\nimport { useRealMobileViewport } from '../../utils/content-utility/real-mobile.ts';\r\n\r\nconst FireworksDisplay = ({ colorMapping = {}, items = [], lastKnownColor, onToggleFireworks }) => {\r\n  const canvasRef = useRef(null);\r\n  const [fireworksEnabled, setFireworksEnabled] = useState(true);\r\n  const fireworksRef = useRef([]);\r\n  const fireworksEnabledRef = useRef(true);\r\n\r\n  const isPageHiddenRef = useRef(false);\r\n  const hiddenStartTimeRef = useRef(0);\r\n  const hiddenDurationRef = useRef(0);\r\n\r\n  const isRealMobile = useRealMobileViewport();\r\n  const isRealMobileRef = useRef(isRealMobile);\r\n\r\n  useEffect(() => {\r\n    isRealMobileRef.current = isRealMobile;\r\n  }, [isRealMobile]);\r\n\r\n  // Documént visibility\r\n  useEffect(() => {\r\n    const handleVisibilityChange = () => {\r\n      if (document.visibilityState === 'hidden') {\r\n        isPageHiddenRef.current = true;\r\n        hiddenStartTimeRef.current = performance.now();\r\n      } else if (document.visibilityState === 'visible') {\r\n        isPageHiddenRef.current = false;\r\n        const now = performance.now();\r\n        hiddenDurationRef.current += now - hiddenStartTimeRef.current;\r\n      }\r\n    };\r\n\r\n    document.addEventListener('visibilitychange', handleVisibilityChange);\r\n    return () => {\r\n      document.removeEventListener('visibilitychange', handleVisibilityChange);\r\n    };\r\n  }, []);\r\n\r\n  // Function to adjust brightness of a hex color\r\n  function adjustBrightness(hex, multiplier) {\r\n    // Convert hex to RGB\r\n    let r = parseInt(hex.slice(1, 3), 16);\r\n    let g = parseInt(hex.slice(3, 5), 16);\r\n    let b = parseInt(hex.slice(5, 7), 16);\r\n\r\n    // Apply brightness multiplier\r\n    r = Math.min(255, Math.max(0, Math.floor(r * multiplier)));\r\n    g = Math.min(255, Math.max(0, Math.floor(g * multiplier)));\r\n    b = Math.min(255, Math.max(0, Math.floor(b * multiplier)));\r\n\r\n    // Convert back to hex and return\r\n    return `#${r.toString(16).padStart(2, '0')}${g.toString(16).padStart(2, '0')}${b.toString(16).padStart(2, '0')}`;\r\n  }\r\n\r\n    const p5InstanceRef = useRef(null); // Track single p5 instance\r\n    const latestItems = useRef(items);\r\n    const latestColorMapping = useRef(colorMapping);\r\n    const latestLastKnownColor = useRef(lastKnownColor);\r\n\r\n  useEffect(() => {\r\n    latestItems.current = items;\r\n    latestColorMapping.current = colorMapping;\r\n    latestLastKnownColor.current = lastKnownColor;\r\n    }, [items, colorMapping, lastKnownColor]);\r\n\r\n  useEffect(() => {\r\n    let destroyed = false;\r\n\r\n    if (!canvasRef.current || p5InstanceRef.current || destroyed) return;\r\n\r\n\r\n      const sketch = (p) => {\r\n        let fireworks = fireworksRef.current;\r\n        let lastFireworkTime = -8000;\r\n        let lastLaunchPosition = p.createVector(p.width / 2, p.height);\r\n        const minDistance = 1000;\r\n\r\n        class Particle {\r\n          constructor(x, y, c, firework, size, type, hasTrail = false) {\r\n            this.pos = p.createVector(x, y);\r\n            this.vel = firework\r\n              ? p.createVector(0, p.random(-10, -20)) // Firework launch velocity\r\n              : p.createVector(p.random(-1, 1), p.random(-1, 1)).mult(p.random(0, 18)); // Explosion velocity\r\n            this.acc = p.createVector(0, 0);\r\n          \r\n            // Adjust brightness based on firework type and size\r\n            this.col = this.adjustBrightness(\r\n              c,\r\n              size > 10\r\n                ? p.random(1.4, 2) // Larger particles\r\n                : size > 5\r\n                ? p.random(1.1, 1.3) // Mid-size particles\r\n                : p.random(0.7, 1.1) // Smaller particles\r\n            );\r\n          \r\n            this.firework = firework;\r\n            this.size = size;\r\n            this.type = type;\r\n            this.hasTrail = hasTrail;\r\n          \r\n            this.shapeType = p.random(['circle', 'square', 'triangle']); // Add random shape selection\r\n          \r\n            // Randomize lifespan based on size (larger particles live longer)\r\n            let minLifespan, maxLifespan;\r\n\r\n            if (p.windowWidth < 768) {\r\n              minLifespan = p.random(30, 60);\r\n              maxLifespan = p.random(40, 80);\r\n            } else if (p.windowWidth <= 1024) {\r\n              minLifespan = p.random(50, 80);\r\n              maxLifespan = p.random(70, 100);\r\n            } else {\r\n              minLifespan = p.random(50, 90);\r\n              maxLifespan = p.random(80, 140);\r\n            }\r\n\r\n            this.lifespan = p.map(size, 1, 12, minLifespan, maxLifespan);\r\n\r\n          \r\n            // Adjust trail length based on particle size\r\n            this.trailLength = size >= 4 && size <= 12 ? 8 : 1; // Longer trail for larger particles\r\n            this.trail = Array(this.trailLength).fill(p.createVector(x, y)); // Set trail array\r\n          \r\n            // Map trailLifespan to speed (higher speed -> higher alpha, lower speed -> fade out)\r\n            const initialSpeed = this.vel.mag();\r\n            this.trailLifespan = Array(this.trailLength).fill(p.map(initialSpeed, 0, 20, 0, 100)); // Dynamically set based on speed\r\n          \r\n            this.fadeFactor = p.map(size, 1, 15, 0.6, 0.5); // Smaller particles fade faster\r\n          \r\n            // Blinking properties (only for explosion particles)\r\n            this.blinkingSpeed = firework ? 0 : p.random(5, 30); // Blinking speed for explosion particles\r\n            this.blinkingAlpha = firework ? 255 : 255; // Default alpha value for explosion particles\r\n          }           \r\n        \r\n          // Adjust brightness of the color\r\n          adjustBrightness(baseColor, multiplier) {\r\n            const r = Math.min(255, Math.max(0, baseColor.levels[0] * multiplier));\r\n            const g = Math.min(255, Math.max(0, baseColor.levels[1] * multiplier));\r\n            const b = Math.min(255, Math.max(0, baseColor.levels[2] * multiplier));\r\n            return p.color(r, g, b);\r\n          }\r\n        \r\n          applyForce(force) {\r\n            this.acc.add(force);\r\n          }\r\n        \r\n          update() {\r\n            this.vel.add(this.acc);\r\n            this.pos.add(this.vel);\r\n            this.acc.mult(0);\r\n        \r\n            if (!this.firework) {\r\n              this.vel.mult(0.927); // Slow down over time\r\n              this.lifespan -= this.fadeFactor; // Decrease lifespan\r\n        \r\n              // Make sure lifespan does not go below 0\r\n              if (this.lifespan <= 0) {\r\n                this.lifespan = 0;\r\n              }\r\n      \r\n              // Trail\r\n              if (this.hasTrail) {\r\n                this.trail.pop(); // Remove the oldest trail point\r\n                this.trail.unshift(this.pos.copy()); // Add the newest trail point\r\n                for (let i = 0; i < this.trailLifespan.length; i++) {\r\n                  this.trailLifespan[i] -= this.fadeFactor; // Gradually fade trail points\r\n                  this.trailLifespan[i] = Math.max(0, this.trailLifespan[i]); // Clamp lifespan to 0\r\n                }\r\n              }\r\n        \r\n              // Apply gravity based on particle size\r\n              let gravityForce;\r\n              if (this.size >= 1 && this.size < 2) {\r\n                gravityForce = p.random(-0.151, -0.161); // Weaker gravity for size 1\r\n              } else if (this.size >= 2 && this.size < 3) {\r\n                gravityForce = p.random(-0.146, -0.156); // Gravity for size 2\r\n              } else if (this.size >= 3 && this.size < 4) {\r\n                gravityForce = p.random(-0.144, -0.145); // Gravity for size 3\r\n              } else if (this.size >= 4 && this.size < 5) {\r\n                gravityForce = p.random(-0.141, -0.143); // Gravity for size 4\r\n              } else if (this.size >= 5 && this.size < 6) {\r\n                gravityForce = p.random(-0.139, -0.14); // Gravity for size 5\r\n              } else if (this.size >= 6 && this.size < 7) {\r\n                gravityForce = p.random(-0.137, -0.138); // Gravity for size 6\r\n              } else if (this.size >= 7 && this.size < 8) {\r\n                gravityForce = p.random(-0.135, -0.136); // Gravity for size 7\r\n              } else if (this.size >= 8 && this.size < 9) {\r\n                gravityForce = p.random(-0.134, -0.136); // Gravity for size 8\r\n              } else if (this.size <= 9) {\r\n                gravityForce = p.random(-0.135, -0.137); // Stronger gravity for size 9\r\n              } else if (this.size >= 10 && this.size <= 12) {\r\n                gravityForce = p.random(-0.094, -0.137); // Stronger gravity for size 9\r\n              }\r\n\r\n              this.applyForce(p.createVector(0, gravityForce)); // Apply gravity\r\n            }\r\n        \r\n            // Update blinking alpha for explosion particles\r\n            if (!this.firework && this.type === 'BLINKING') {\r\n              this.blinkingAlpha = Math.abs(255 * Math.sin((p.millis() / 1000) * this.blinkingSpeed));\r\n            }\r\n          }\r\n        \r\n          show() {\r\n            let alpha = this.firework\r\n              ? p.map(this.lifespan, 0, 255, 0, 255) // Normal fading for firework particles\r\n              : this.type === 'BLINKING'\r\n              ? this.blinkingAlpha // Blinking for explosion particles\r\n              : p.map(this.lifespan, 0, 255, 0, 255); // Fading for explosion particles\r\n          \r\n            p.noStroke();\r\n          \r\n            // Shrinking logic for the particle\r\n            let shrinkSize = this.size;\r\n            if (!this.firework) {\r\n              // Lifespan timing: calculate elapsed time (255 lifespan = full life)\r\n              const elapsedTime = p.map(this.lifespan, 255, 0, 0, 5); // 5 seconds total lifespan\r\n              const shrinkFactor = elapsedTime <= 2\r\n                ? 1 // No shrinking for the first 2 seconds\r\n                : p.map(this.lifespan, 255, 0, 1, 0); // Start shrinking after 2 seconds\r\n          \r\n              // Exponential shrinking towards the end\r\n              shrinkSize = this.size * (1 - Math.pow(1 - shrinkFactor, 6)); \r\n            }\r\n          \r\n            const normalizedSize = Math.max(shrinkSize * 1.1, 1); // Clamp minimum size to 1\r\n          \r\n            // Calculate rotation angle based on velocity vector\r\n            const rotationAngle = p.atan2(this.vel.y, this.vel.x); // Angle in radians\r\n          \r\n            // Draw trails first\r\n            if (this.hasTrail) {\r\n              for (let i = 0; i < this.trail.length; i++) {\r\n                const trailAlpha = this.trailLifespan[i];\r\n                if (trailAlpha > 0) {\r\n                  // Use a fixed size for trail points\r\n                  const trailSize = this.firework ? this.size * 0.9 : this.size * 0.8;\r\n            \r\n                  p.strokeWeight(trailSize); // Fixed trail size\r\n                  p.stroke(\r\n                    this.col.levels[0],\r\n                    this.col.levels[1],\r\n                    this.col.levels[2],\r\n                    trailAlpha\r\n                  );\r\n                  p.point(this.trail[i].x, this.trail[i].y);\r\n                }\r\n              }\r\n            }\r\n          \r\n            // Draw the main particle shape\r\n            p.push();\r\n            p.translate(this.pos.x, this.pos.y); // Move to particle position\r\n            p.rotate(rotationAngle); // Rotate based on velocity direction\r\n          \r\n            // Apply speed-based rotation scaling (optional)\r\n            const rotationSpeed = this.vel.mag() * 0.01; // Scale speed to adjust rotation dynamics\r\n            p.rotate(p.frameCount * rotationSpeed);\r\n          \r\n            p.fill(this.col.levels[0], this.col.levels[1], this.col.levels[2], alpha);\r\n          \r\n            // Draw shape based on shapeType\r\n            if (this.shapeType === 'circle') {\r\n              p.ellipse(0, 0, normalizedSize, normalizedSize);\r\n            } else if (this.shapeType === 'square') {\r\n              const halfSize = normalizedSize / 2;\r\n              p.rect(-halfSize, -halfSize, normalizedSize, normalizedSize);\r\n            } else if (this.shapeType === 'triangle') {\r\n              const halfSize = normalizedSize / 2;\r\n              p.triangle(\r\n                0, -halfSize, // Top vertex\r\n                -halfSize, halfSize, // Bottom-left vertex\r\n                halfSize, halfSize // Bottom-right vertex\r\n              );\r\n            }\r\n          \r\n            p.pop(); // Reset transformations\r\n          }        \r\n                      \r\n          // Check if the particle is done (lifespan is 0)\r\n          isDone() {\r\n            return this.lifespan <= 0; // Particle is done when lifespan is depleted\r\n          }\r\n        }\r\n        \r\n        class Firework {\r\n          constructor(x, y, targetX, targetY, col, type) {\r\n            this.firework = new Particle(x, y, col, true, 4, type);\r\n            this.particles = [];\r\n            this.exploded = false;\r\n            this.targetX = targetX;\r\n        \r\n            // Adjust explosion location based on screen width\r\n            if (p.windowWidth < 768) {\r\n              // For screens smaller than 768px, make the explosion higher on the screen\r\n              this.targetX = p.random(p.width * 0.5, p.width * 0.9);  \r\n              this.targetY = p.random(p.height * 0.1, p.height * 0.3);  \r\n              } else if (p.windowWidth >= 768 && p.windowWidth <= 1024) {\r\n              // For screens between 768px and 1024px, make the explosion in the middle\r\n              this.targetX = p.random(p.width * 0.65, p.width * 0.9);  \r\n              this.targetY = p.random(p.height * 0.05, p.height * 0.3);  \r\n              } else {\r\n              // For screens larger than 1024px, make the explosion lower on the screen\r\n              this.targetX = p.random(p.width * 0.3, p.width * 0.7);  \r\n              this.targetY = p.random(p.height * 0.05, p.height * 0.4);  \r\n            }\r\n        \r\n            this.col = col;\r\n            this.type = type;\r\n            this.explosionStartTime = -1;\r\n\r\n            // Particle amount logic\r\n            let baseCount;\r\n          if (p.windowWidth < 768) {\r\n            baseCount = type === 'BLINKING'\r\n              ? p.random(150, 275)\r\n              : p.random(125, 225);\r\n          } else if (p.windowWidth <= 1024) {\r\n            baseCount = type === 'BLINKING'\r\n              ? p.random(275, 325)\r\n              : p.random(200, 250); // Fewer PROJECTILE particles on medium screens\r\n          } else {\r\n            baseCount = type === 'BLINKING'\r\n              ? p.random(250, 300)\r\n              : p.random(300, 350);\r\n            }\r\n            this.numParticles = Math.floor(baseCount);\r\n          }\r\n        \r\n          explode() {\r\n            // Capture the firework's initial velocity to influence explosion particles\r\n            let initialVel = this.firework.vel.copy(); // Copy firework's velocity to influence explosion\r\n            \r\n            //limit particle count for larger ones between 25 to 50\r\n            const largerParticleCount = this.type === 'PROJECTILE' ? Math.floor(p.random(25, 50)) : 0;\r\n\r\n            for (let i = 0; i < this.numParticles; i++) {\r\n              let size;\r\n          \r\n              // Assign size based on whether it's a larger particle or a regular one\r\n              if (this.type === 'PROJECTILE' && i < largerParticleCount) {\r\n                size = p.random(10, 12); // Extra large particles for PROJECTILE\r\n              } else {\r\n                size = this.type === 'BLINKING' ? p.random(1, 9) : p.random(1, 8); // Smaller particles\r\n              }\r\n          \r\n              let speed = this.type === 'BLINKING'\r\n              ? (() => {\r\n                  // Inline definition for BLINKING firework speed calculation\r\n                  let speed;\r\n                  if (size >= 1 && size < 2) {\r\n                    speed = p.random(0.5, 2.7);\r\n                  } else if (size >= 2 && size < 3) {\r\n                    speed = p.random(2.5, 4.7);\r\n                  } else if (size >= 3 && size < 4) {\r\n                    speed = p.random(4.5, 6.7);\r\n                  } else if (size >= 4 && size < 5) {\r\n                    speed = p.random(6.5, 8.7);\r\n                  } else if (size >= 5 && size < 6) {\r\n                    speed = p.random(8.5, 8.7);\r\n                  } else if (size >= 6 && size < 7) {\r\n                    speed = p.random(8.8, 9);\r\n                  } else if (size >= 7 && size < 8) {\r\n                    speed = p.random(9.1, 9.2);\r\n                  } else if (size >= 8 && size < 9) {\r\n                    speed = p.random(9.2, 9.3);\r\n                  } else {\r\n                    speed = p.random(9.4, 9.5);\r\n                  }\r\n                  return adjustForScreenWidth(speed);\r\n                })()\r\n              : (() => {\r\n                  // Inline definition for PROJECTILE firework speed calculation\r\n                  let speed;\r\n                  if (size >= 1 && size < 7) {\r\n                    speed = p.random(1, 9);\r\n                  } else if (size >= 7 && size < 9) {\r\n                    speed = p.random(8, 9);\r\n                  } else if (size >= 10 && size < 12) {\r\n                    speed = p.random(9, 9.2);\r\n                  } else {\r\n                    speed = p.random(1, 4);\r\n                  }\r\n                  return adjustForScreenWidth(speed);\r\n                })();\r\n            \r\n            // Function to adjust speed based on screen size\r\n            function adjustForScreenWidth(speed) {\r\n              let screenWidth = p.windowWidth;\r\n              let screenMultiplier = 1; // Default multiplier\r\n            \r\n              if (screenWidth < 768) {\r\n                screenMultiplier = p.random(1.8, 2.6);\r\n              } else if (screenWidth >= 768 && screenWidth <= 1024) {\r\n                screenMultiplier = p.random(1.6, 2.2);\r\n              } else if (screenWidth > 1024) {\r\n                screenMultiplier = p.random(1.2, 2.2);\r\n              } \r\n              return speed * screenMultiplier;\r\n            }\r\n          \r\n              let angle = p.random(p.TWO_PI);\r\n              let velocity = p.createVector(p.cos(angle), p.sin(angle)).mult(speed);\r\n              \r\n              // Apply a smaller influence from firework velocity if particle is in line with the projectile\r\n              let angleDiff = Math.abs(p.atan2(velocity.y, velocity.x) - p.atan2(initialVel.y, initialVel.x));\r\n              \r\n              // If angle difference is small (i.e., the particle is moving along the same vector as the firework's trajectory), apply less multiplier\r\n              let velocityMultiplier = angleDiff < p.HALF_PI / 4 ? p.random(0, 0.5) : p.random(0.5, 0.8);\r\n              velocity.add(initialVel.mult(velocityMultiplier)); // Small influence from projectile velocity\r\n          \r\n              let hasTrail = size > 6; // Larger particles have trails\r\n                  \r\n              let type = 'BLINKING';\r\n              let particle = new Particle(\r\n                this.firework.pos.x + p.random(-2, 6),\r\n                this.firework.pos.y + p.random(-2, 6),\r\n                this.col,\r\n                false,\r\n                size,\r\n                type,\r\n                hasTrail\r\n              );\r\n                  \r\n              particle.vel = velocity;\r\n              this.particles.push(particle);\r\n            }\r\n            this.exploded = true;\r\n            this.explosionStartTime = p.millis();\r\n          }\r\n          \r\n          update() {\r\n            if (!this.exploded) {\r\n              let direction = p.createVector(this.targetX - this.firework.pos.x, this.targetY - this.firework.pos.y);\r\n              direction.normalize();\r\n              let launchSpeed;\r\n                if (p.windowWidth < 768) {\r\n                  launchSpeed = p.random(6, 11);\r\n                } else if (p.windowWidth <= 1024) {\r\n                  launchSpeed = p.random(5, 9); // Moderate speed boost for medium screens\r\n                } else {\r\n                  launchSpeed = p.random(3, 8);\r\n                }\r\n\r\n              direction.mult(launchSpeed);\r\n              this.firework.vel = direction;\r\n              this.firework.update();\r\n              if (p.dist(this.firework.pos.x, this.firework.pos.y, this.targetX, this.targetY) < 10) {\r\n                this.explode();\r\n              }\r\n            }\r\n            for (let i = this.particles.length - 1; i >= 0; i--) {\r\n              let particle = this.particles[i];\r\n              particle.applyForce(p.createVector(0, 0.160));  // Apply gravity force\r\n              particle.update();\r\n              if (particle.isDone()) {\r\n                this.particles.splice(i, 1);\r\n              }\r\n            }\r\n          }\r\n\r\n          show() {\r\n            if (!this.exploded) {\r\n              this.firework.show();\r\n            }\r\n            for (let particle of this.particles) {\r\n              particle.show();\r\n            }\r\n          }\r\n        }\r\n\r\n        function addNewFirework(fireworkType) {\r\n\r\n          const startX = p.width / 2;\r\n          const startY = p.height;\r\n\r\n          const selectedAlt1 = latestItems.current?.[0]?.alt1 || '';\r\n          const colorArray = latestColorMapping.current[selectedAlt1] || [];\r\n\r\n          // Early exit if no colors are available\r\n          if (!colorArray.length) {\r\n            console.warn(`No colors available for alt1: '${selectedAlt1}'`);\r\n            return;\r\n          }\r\n\r\n          let topColorCount;\r\n          if (p.windowWidth >= 1025) {\r\n            topColorCount = 3;\r\n          } else if (p.windowWidth >= 768) {\r\n            topColorCount = 2;\r\n          } else {\r\n            topColorCount = 1;\r\n          }\r\n\r\n          // Safely extract just 0, 1, and 3 (skip index 2)\r\n          const usableColors = [\r\n            colorArray[0],\r\n            colorArray[1],\r\n            colorArray[3],\r\n          ].filter(Boolean); // filter out undefined if array is incomplete\r\n          if (usableColors.length === 0) return;\r\n\r\n          const randomHex = usableColors[Math.floor(p.random(usableColors.length))]; // Pick one color\r\n\r\n          const brightnessMultiplier = p.random(1, 1.4);\r\n          const adjustedHex = adjustBrightness(randomHex, brightnessMultiplier);\r\n          const fireworkColor = p.color(adjustedHex);\r\n\r\n          const targetX = p.width / 2 + p.random(-50, 50);\r\n          const targetY = fireworkType === 'BLINKING' ? p.height * 0.2 : p.height * 0.7;\r\n\r\n          lastLaunchPosition = p.createVector(targetX, targetY);\r\n          fireworks.push(new Firework(startX, startY, targetX, targetY, fireworkColor, fireworkType));\r\n        }\r\n\r\n        p.setup = () => {\r\n          p.createCanvas(p.windowWidth, p.windowHeight);\r\n          const firstFireworkType = Math.random() < 0.5 ? 'BLINKING' : 'PROJECTILE'; // Randomize first firework type\r\n          addNewFirework(firstFireworkType); // Launch the first firework\r\n          lastFireworkTime = p.millis(); // Reset lastFireworkTime after the first launch\r\n        };      \r\n\r\n        hiddenDurationRef.current = 0;\r\n        lastFireworkTime = 0;\r\n        \r\n        let fireworkToggle = true; // Starts with BLINKING\r\n        let nextFireworkDelay = p.random(3000, 7000); // Random delay between 2000ms and 5000ms\r\n\r\n        p.draw = () => {\r\n          if (isRealMobileRef.current) {\r\n            p.clear(); // transparent\r\n          } else {\r\n            p.background('#1e1e1f'); // fallback\r\n          }\r\n            \r\n          if (!fireworksEnabledRef.current) {\r\n            fireworksRef.current.length = 0;\r\n            return;\r\n          }\r\n\r\n          for (let firework of fireworks) {\r\n            firework.update();\r\n            firework.show();\r\n          }\r\n\r\n          const adjustedTime = p.millis() - hiddenDurationRef.current;\r\n\r\n          // Fix: fallback in case adjustedTime went backward or got corrupted\r\n          if (adjustedTime < lastFireworkTime) {\r\n            console.warn(\"Adjusted time went backward or stale. Forcing firework reset.\");\r\n            lastFireworkTime = adjustedTime - nextFireworkDelay - 1;\r\n          }\r\n\r\n          // Regular triggering condition\r\n          if (adjustedTime - lastFireworkTime > nextFireworkDelay) {\r\n            const fireworkType = fireworkToggle ? 'BLINKING' : 'PROJECTILE';\r\n            addNewFirework(fireworkType);\r\n            fireworkToggle = !fireworkToggle;\r\n            lastFireworkTime = adjustedTime;\r\n            nextFireworkDelay = p.random(2000, 8000);\r\n          }\r\n        };\r\n      };\r\n      \r\n    p5InstanceRef.current = new q5(sketch, canvasRef.current);\r\n\r\n    return () => {\r\n      destroyed = true;\r\n      if (p5InstanceRef.current) {\r\n        p5InstanceRef.current.remove();\r\n        p5InstanceRef.current = null;\r\n      }\r\n      fireworksRef.current = [];\r\n    };\r\n  }, []);\r\n\r\n  const toggleFireworks = useCallback((isEnabled) => {\r\n    setFireworksEnabled(isEnabled);\r\n    fireworksEnabledRef.current = isEnabled; // update live value for q5\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    if (onToggleFireworks) {\r\n      onToggleFireworks(toggleFireworks);\r\n    }\r\n  }, [onToggleFireworks, toggleFireworks]); // Ensure dependencies are stable  \r\n\r\n  return <div ref={canvasRef}></div>;\r\n};\r\n\r\nexport default FireworksDisplay;","// useRealMobileViewport.ts\r\nimport { useEffect, useState } from 'react';\r\n\r\nexport function useRealMobileViewport() {\r\n  const [isRealMobile, setIsRealMobile] = useState(false);\r\n\r\n  useEffect(() => {\r\n    const checkMobile = () => {\r\n      const touch = navigator.maxTouchPoints > 0;\r\n      const coarse = window.matchMedia?.('(pointer: coarse)').matches ?? false;\r\n      const width = window.innerWidth;\r\n      const ua = navigator.userAgent || navigator.vendor || (window as any).opera;\r\n\r\n      // iOS detection (iPhone / iPad)\r\n      const isIOS = /iPad|iPhone|iPod/.test(ua) ||\r\n        (navigator.platform === 'MacIntel' && touch); // iPadOS pretends to be Mac\r\n\r\n      // Android detection\r\n      const isAndroid = /Android/.test(ua);\r\n\r\n      // Consider it real mobile if:\r\n      // - Touch exists, and viewport is small, or\r\n      // - Known mobile UA\r\n      const realMobile =\r\n        (touch && width <= 1024) ||\r\n        isIOS ||\r\n        isAndroid ||\r\n        coarse;\r\n\r\n      setIsRealMobile(realMobile);\r\n    };\r\n\r\n    checkMobile();\r\n    window.addEventListener('resize', checkMobile);\r\n    window.addEventListener('orientationchange', checkMobile);\r\n\r\n    return () => {\r\n      window.removeEventListener('resize', checkMobile);\r\n      window.removeEventListener('orientationchange', checkMobile);\r\n    };\r\n  }, []);\r\n\r\n  return isRealMobile;\r\n}\r\n"],"names":["_ref","colorMapping","items","lastKnownColor","onToggleFireworks","canvasRef","useRef","fireworksEnabled","setFireworksEnabled","useState","fireworksRef","fireworksEnabledRef","isPageHiddenRef","hiddenStartTimeRef","hiddenDurationRef","isRealMobile","useRealMobileViewport","isRealMobileRef","useEffect","current","handleVisibilityChange","document","visibilityState","performance","now","addEventListener","removeEventListener","p5InstanceRef","latestItems","latestColorMapping","latestLastKnownColor","destroyed","q5","p","fireworks","lastFireworkTime","lastLaunchPosition","createVector","width","height","Particle","constructor","x","y","c","firework","size","type","minLifespan","maxLifespan","hasTrail","arguments","length","undefined","this","pos","vel","random","mult","acc","col","adjustBrightness","shapeType","windowWidth","lifespan","map","trailLength","trail","Array","fill","initialSpeed","mag","trailLifespan","fadeFactor","blinkingSpeed","blinkingAlpha","baseColor","multiplier","r","Math","min","max","levels","g","b","color","applyForce","force","add","update","pop","unshift","copy","i","gravityForce","abs","sin","millis","show","alpha","noStroke","shrinkSize","shrinkFactor","pow","normalizedSize","rotationAngle","atan2","trailAlpha","trailSize","strokeWeight","stroke","point","push","translate","rotate","rotationSpeed","frameCount","ellipse","halfSize","rect","triangle","isDone","Firework","targetX","targetY","baseCount","particles","exploded","explosionStartTime","numParticles","floor","explode","initialVel","largerParticleCount","speed","adjustForScreenWidth","screenWidth","screenMultiplier","angle","TWO_PI","velocity","cos","velocityMultiplier","HALF_PI","particle","launchSpeed","direction","normalize","dist","splice","addNewFirework","fireworkType","_latestItems$current","_latestItems$current$","startX","startY","selectedAlt1","alt1","colorArray","console","warn","concat","topColorCount","usableColors","filter","Boolean","adjustedHex","hex","parseInt","slice","toString","padStart","fireworkColor","setup","createCanvas","windowHeight","fireworkToggle","nextFireworkDelay","draw","clear","background","adjustedTime","remove","toggleFireworks","useCallback","isEnabled","_jsx","ref","setIsRealMobile","checkMobile","_window$matchMedia$ma","_window$matchMedia","_window","touch","navigator","maxTouchPoints","coarse","window","matchMedia","call","matches","innerWidth","ua","userAgent","vendor","opera","isIOS","test","platform","isAndroid"],"sourceRoot":""}