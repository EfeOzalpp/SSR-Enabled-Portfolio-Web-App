"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[179],{21808:(e,t,n)=>{n.r(t),n.d(t,{default:()=>A});var o=n(31014),l=n(4137),i=n(9381),r=n.n(i),a=n(43431),s=n(73079),c=n(68493),u=n(32247),d=n(46550);const m=e=>{let{onStart:t,resetTrigger:n,label:l="Click Here to Play!",ctaEnabled:i=!0,loadingLines:m=["Loading engine\u2026","Creating game canvas\u2026","Configuring frame loop\u2026","Setting up input controls\u2026","Applying display settings\u2026","Initializing game state\u2026","Spawning player\u2026","Almost ready\u2026"]}=e;const[g,p]=(0,o.useState)(!0),[v,h]=(0,o.useState)(!1),y=(0,o.useRef)(null),f=(0,o.useRef)(null),b=(0,o.useRef)(null);(0,c.h)();const{focusedProjectKey:w,scrollContainerRef:E,previousScrollY:x,setPreviousScrollY:T}=(0,s.X)(),k=()=>{i&&(w&&(T(window.scrollY),setTimeout(()=>{E.current?E.current.scrollTo({top:0,behavior:"auto"}):window.scrollTo({top:0,behavior:"auto"})},0)),null===t||void 0===t||t(),h(!0))};(0,o.useEffect)(()=>{},[]);const S=()=>{var e;null===(e=b.current)||void 0===e||e.destroy(),b.current=null};return(0,o.useEffect)(()=>{const e=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?((()=>{var e;y.current&&(null===(e=b.current)||void 0===e||e.destroy(),b.current=r().loadAnimation({container:y.current,renderer:"svg",loop:!1,autoplay:!1,animationData:a}),b.current.addEventListener("complete",()=>{b.current&&(b.current.playSegments([41,b.current.totalFrames],!0),b.current.loop=!0)}))})(),b.current&&(b.current.stop(),b.current.playSegments([0,b.current.totalFrames],!0))):S()})},{threshold:.1});return f.current&&e.observe(f.current),()=>{e.disconnect(),S()}},[n]),(0,o.useEffect)(()=>{if(v){const e=setTimeout(()=>p(!1),300);return()=>clearTimeout(e)}},[v]),(0,o.useEffect)(()=>{n&&(p(!0),h(!1))},[n]),g?(0,d.jsxs)("div",{className:"block-g-onboarding tooltip-block-g",ref:f,"aria-busy":!i,style:{opacity:v?0:1,transition:"opacity 0.3s ease",display:"flex",alignItems:"center"},children:[(0,d.jsx)("div",{ref:y,className:"coin",onClick:k,style:{pointerEvents:i?"auto":"none",cursor:i?"pointer":"default"}}),(0,d.jsx)("h1",{className:"onboarding-text",onClick:k,"aria-disabled":!i,style:{pointerEvents:i?"auto":"none",cursor:i?"pointer":"default"},children:l}),!i&&(0,d.jsx)(u.A,{className:"loading-hub--game loading-hub--left",keyword:"game",minHeight:72,lines:m,ariaLabel:"Loading game"})]}):null};var g=n(17869),p=n(75685),v=n(61460),h=n(53451),y=n(18828),f=n(91426),b=n(8786),w=n(88207),E=n(76585),x=n(41195),T=n(46431);const k="game-mode-active";function S(){"undefined"!==typeof document&&document.body.classList.remove(k)}function A(e){let{blockId:t}=e;const i=(0,h.e)(),[r,a]=(0,o.useState)(!1),[s,c]=(0,o.useState)(!1),[u,A]=(0,o.useState)(0),[L,C]=(0,o.useState)(null),[I,j]=(0,o.useState)(!1),[M,H]=(0,o.useState)(!1),[O,_]=(0,o.useState)(!1),D=(0,o.useRef)(null),[R,F]=(0,o.useState)(null),N=(0,E.t)(),B="number"===typeof N?N:0,P=(0,o.useRef)(null);(0,o.useEffect)(()=>{const e=window.requestIdleCallback;let t=null;return e&&(t=e(()=>{w.nJ.game()},{timeout:2e3})),()=>{var e,n;return t&&(null===(e=(n=window).cancelIdleCallback)||void 0===e?void 0:e.call(n,t))}},[]);const q=(0,o.useCallback)(async()=>{w.nJ.game(),A(0),F(null),C("lottie"),"undefined"!==typeof document&&document.body.classList.add(k),a(!0),requestAnimationFrame(()=>{var e,n;const o=document.getElementById(t);null===o||void 0===o||null===(e=(n=o).focus)||void 0===e||e.call(n)})},[t]);(0,o.useEffect)(()=>{if("lottie"!==L||!D.current)return;let e,t=!0;return(async()=>{if(e=await l.A.loadAnimation({container:D.current,renderer:"svg",loop:!1,autoplay:!0,animationData:i?f:y}),!t||!e)return;const n=()=>C("begin");e.addEventListener("complete",n)})(),()=>{var n,o;t=!1,null===(n=e)||void 0===n||null===(o=n.destroy)||void 0===o||o.call(n)}},[L,i]),(0,o.useEffect)(()=>{if("begin"===L){j(!0);const e=setTimeout(()=>{j(!1),C(null)},1e3);return()=>clearTimeout(e)}},[L]),(0,o.useEffect)(()=>{if("lottie"===L)H(!0),_(!0);else if(null===L){H(!1);const e=setTimeout(()=>_(!1),400);return()=>clearTimeout(e)}},[L]);const W=e=>{P.current=e,c(!0)};(0,o.useEffect)(()=>()=>S(),[]);const z=(null==R?u:R)>B?null==R?u:R:B,G=null==R&&u>B;return(0,d.jsxs)("section",{id:t,tabIndex:-1,className:"block-type-g",style:{position:"relative"},children:[(0,d.jsx)(x.A,{active:r,lockBodyScroll:!0,alsoBlockWheel:!0,alsoBlockTouch:!0,allowWhenTyping:!0}),!r&&(0,d.jsx)(m,{onStart:q,resetTrigger:r?1:0,label:s?"Click Here to Play!":"Loading Game\u2026",ctaEnabled:s}),!r&&(0,d.jsx)(b.A,{load:()=>n.e(874).then(n.bind(n,66874)),fallback:null,mountMode:"io",observeTargetId:t,rootMargin:"0px",enterThreshold:.2,exitThreshold:.05,unmountDelayMs:150,preloadOnIdle:!0,preloadIdleTimeout:2e3,preloadOnFirstIO:!0,placeholderMinHeight:360,componentProps:{onReady:W,onCoinsChange:()=>{},onGameOver:()=>{},highScore:B,pauseWhenHidden:!0,demoMode:!0,overlayActive:!1,allowSpawns:!0}}),r&&(0,d.jsxs)(T.A,{children:[(0,d.jsx)(p.A,{onExit:()=>{a(!1),C(null),A(0),F(null),S()}}),(0,d.jsx)(g.A,{coins:u,highScore:z,newHighScore:G}),O&&(0,d.jsx)("div",{className:"countdown-bg-overlay ".concat(M?"":"hide"),style:{pointerEvents:"none"}}),("lottie"===L||"begin"===L)&&(0,d.jsx)("div",{ref:D,id:"lottie-onboarding",className:"countdown-lottie",style:{pointerEvents:"none"}}),(0,d.jsx)(v.A,{score:R,highScore:B,onRestart:()=>{var e;C(null),null===(e=P.current)||void 0===e||e.restart(),A(0)},onHide:()=>F(null)}),(0,d.jsx)(b.A,{load:()=>n.e(874).then(n.bind(n,66874)),fallback:null,mountMode:"io",observeTargetId:"game-viewport-root",rootMargin:"0px",enterThreshold:.01,exitThreshold:0,unmountDelayMs:150,preloadOnIdle:!0,preloadIdleTimeout:2e3,preloadOnFirstIO:!0,placeholderMinHeight:360,componentProps:{onReady:W,onCoinsChange:e=>A(e),onGameOver:e=>F(e),highScore:B,pauseWhenHidden:!0,demoMode:!1,overlayActive:"lottie"===L||"begin"===L,allowSpawns:"begin"===L||null===L}})]})]})}},68493:(e,t,n)=>{n.d(t,{h:()=>y});var o=n(31014),l=n(21710);const i={},r={"block-g":["#q5.js Canvas","#Gamification","#Lottie Animation"]},a={"rotary-lamp":"Rotary Lamp","ice-scoop":"Ice Cream Scoop","data-viz":"Data Visualization","block-g":"Evade the Rock",dynamic:"Dynamic App"};let s=null,c="",u=null;const d=async e=>{if(i[e])return i[e];const t=function(e){var t;const n=l.s[a[e]],o=null!==(t=null===n||void 0===n?void 0:n.tooltipAlpha)&&void 0!==t?t:.6;return n?"rgba(".concat(n.rgb,", ").concat(o,")"):"rgba(85,95,90,0.6)"}(e);if(r[e]){const n={tags:r[e],backgroundColor:t};return i[e]=n,n}try{var o;const l=(await Promise.resolve().then(n.bind(n,78267))).default,r=await l.fetch('*[_type=="mediaBlock" && slug.current == $key][0]{ tags }',{key:e}),a={tags:null!==(o=null===r||void 0===r?void 0:r.tags)&&void 0!==o?o:[],backgroundColor:t};return i[e]=a,a}catch(s){const n={tags:[],backgroundColor:t};return i[e]=n,n}},m=()=>{s&&(u&&clearTimeout(u),s.style.opacity="1",s.style.visibility="visible",u=setTimeout(()=>g(),1500))},g=()=>{s&&(u&&clearTimeout(u),s.style.opacity="0",s.style.visibility="hidden",c="")};function p(e,t){if(!s)return;const n=s.getBoundingClientRect(),o=window.innerWidth,l=window.innerHeight,i=t<n.height+0+20,r=t+n.height+0>l-20,a=e+n.width+0>o-20,c=e<n.width+0+20;let u,d;r?(d=t-n.height-0-8,u=e-0*n.width):i?(d=t+0-14,u=e-0*n.width):a?(d=t-n.height/2,u=e-n.width-0-24):c?(d=t-n.height/2,u=e+0-4):(d=t-n.height/1.6,u=e+0-2),u=Math.max(0,Math.min(u,o-n.width-0)),d=Math.max(0,Math.min(d,l-n.height-0)),s.style.left="".concat(u,"px"),s.style.top="".concat(d,"px")}function v(e){if(s)return()=>{};s=function(){const e=document.createElement("div");return e.id="custom-global-tooltip",e.style.position="fixed",e.style.pointerEvents="none",e.style.zIndex="9999",e.style.opacity="0",e.style.visibility="hidden",e.style.backdropFilter="blur(8px)",e.style.color="#fff",e.style.transition="opacity 0.3s ease, visibility 0.3s ease",e.className="custom-tooltip-blur",(document.getElementById("efe-portfolio")||document.body).appendChild(e),e}();let t=-1,n=-1,o=!1,l=null;const i=async e=>{if(!(e instanceof HTMLElement))return void g();const t=[...e.classList].find(e=>e.startsWith("tooltip-"));if(!t)return void g();const n=t.replace("tooltip-","");if(n!==c){c=n;const e=await d(n);if(!e.tags.length)return void g();s.innerHTML=e.tags.map(e=>'<p class="tooltip-tag">'.concat(e,"</p>")).join(""),s.style.backgroundColor=e.backgroundColor,m()}else"0"!==s.style.opacity&&"hidden"!==s.style.visibility||m()},r=e=>{t=e.clientX,n=e.clientY,requestAnimationFrame(()=>p(t,n)),i(e.target)},a=()=>{o||(window.requestAnimationFrame(()=>{(()=>{const e=document.elementFromPoint(t,n);i(e),requestAnimationFrame(()=>p(t,n))})(),o=!1}),o=!0),l&&clearTimeout(l),l=setTimeout(()=>{},120)},v=e=>{e.relatedTarget||g()};return e||window.addEventListener("scroll",a,!0),document.addEventListener("mousemove",r,{passive:!0}),document.addEventListener("mouseout",v,{passive:!0}),()=>{s&&(e||window.removeEventListener("scroll",a,!0),document.removeEventListener("mousemove",r),document.removeEventListener("mouseout",v),s.remove(),s=null,u&&clearTimeout(u))}}var h=n(53451);const y=()=>{const e=(0,h.e)();(0,o.useEffect)(()=>{const t=v(e);return()=>null===t||void 0===t?void 0:t()},[e])}}}]);
//# sourceMappingURL=components.0d17b8f1.chunk.js.map