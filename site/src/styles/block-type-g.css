/* Rock Escapade */
.block-type-g { max-width: 100%; height: 98dvh; width: 100vw; display: flex; flex-wrap: wrap; align-content: space-between; background: #1c1c1c; }
.q5-normal { width: 100%; height: 100%; }

#block-game .g-hydrate-root,
#block-game .block-g-stage, #block-game .block-g-stage > div  {
height: 92dvh; width: 100vw; }

#block-game.is-immersive .g-hydrate-root,
#block-game.is-immersive .block-g-stage,
#block-game.is-immersive .block-g-stage > div {
  height: 100dvh !important; /* take full viewport during gameplay */
}

.block-type-g .evade-the-rock canvas {
  touch-action: none;
  -webkit-user-select: none;
  user-select: none;
}

.countdown-display { position: absolute; top: 0px; left: 0px; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; z-index: 9999; pointer-events: none; }

.coin-counter { padding-left: 16px; width: calc(100% - 32px); top: 8px; position: absolute; z-index: 10000; pointer-events: none; display: flex; flex-direction: row; justify-content: space-between; }
.coin-count { align-items: center; display: flex; flex-direction: row; justify-content: flex-start; flex-wrap: nowrap;}
.coin-lottie {width: 2em;} .coin2 {width: 4em;}
.coin-amount { padding-left: 8px; color: rgb(255, 205, 55); text-shadow: 0px 0px 32px rgb(25 25 25); }
.high-score {  text-shadow: 0px 0px 32px rgb(25 25 25); padding: 3px; text-decoration: underline;}

.block-g-onboarding { top: 0; left: 0; width: 100%; height: 100%; background: transparent; display: flex; align-items: center; justify-content: center; z-index: 999; position: absolute; flex-direction: column; }
.coin, .onboarding-text {cursor: pointer;} 

.onboarding-text { text-shadow: 0px 0px 48px rgb(25 25 25); color: #fac23f;  mix-blend-mode: screen;}
.onboarding-text:hover {color: #f6c552; scale: 1.06;}
.coin:hover {scale: 1.1;}

.countdown-lottie {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  z-index: 2000; /* Must be higher than canvas (which uses 1500) */
  pointer-events: none; /* Optional: So it doesn't block input */
}
.countdown-bg-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100vw;
  height: 100vh;
  background: radial-gradient(
    circle at center,
    rgb(27, 27, 28) 0%,
    rgb(20, 20, 20) 50%,
    rgb(10, 10, 10) 100%
  );
  opacity: 1;
  transition: opacity 0.4s ease;
  z-index: 1999;
  pointer-events: none;
}
.countdown-bg-overlay.hide {
  opacity: 0;
}

/* game over */
.block-g-gameover { position: absolute; top: 0; left: 0; width: 100%; height: 100%;   background: radial-gradient(
    circle at center,
    rgb(27, 27, 28) 0%,
    rgb(20, 20, 20) 50%,
    rgb(10, 10, 10) 100%
  ); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer;}
.gameover-overlay { z-index: 10050;}
.gameover-text { color: whitesmoke;}
.gameover-text-area { display: flex; flex-direction: column; align-items: center; position: absolute;}
.gameover-cta {
  animation: blink-opacity 3.6s infinite;
  text-shadow: 0px 0px 80px rgba(255, 205, 55, 0.655);
}

@keyframes blink-opacity {
  0%, 100% {
    opacity: 1;
  }
  50% {
    opacity: 0.6;
  }
}

/* exit */
.block-g-exit { position: fixed; bottom: 24px; left: 24px; background: rgb(45 45 45 / 70%); color: white; padding: 4px 32px; cursor: pointer; z-index: 10100; }
.block-g-exit:hover {background-color: rgb(52, 52, 52);}

@media (orientation: portrait) {
  .block-g-onboarding { flex-direction: column; }
}

@media (orientation: landscape) {
  .block-g-onboarding { flex-direction: row !important; }
  .onboarding-text {padding-top: 2.4em; padding-bottom: 2.4em;}
}
body.game-mode-active .project-pane#block-game .project-pane-wrapper {height: 100dvh;}
body.game-mode-active .project-pane#block-game {z-index: 10000; position: relative;}
@media (max-width: 768px) {
  #block-game .g-hydrate-root,
  #block-game .block-g-stage, #block-game .block-g-stage > div  {
  height: 98dvh !important; }
  .block-type-g { height: 98dvh; }
  .coin { width: 14em; } 
  .gameover-text-area {bottom: 168px;}
  .gameover-lottie {width: calc(100% + 32em); margin-top: -168px;}
  .countdown-lottie  {transform: scale(0.9);}
}

@media (min-width: 768px) and (max-width: 1024px) {
  #block-game .g-hydrate-root,
  #block-game .block-g-stage, #block-game .block-g-stage > div  {
  height: 92dvh !important; }
  .block-g-exit h4 { padding-left: 0.4em; padding-right: 0.4em; }
  .block-type-g { height: 92dvh !important; }
  .coin { width: 12em; } 
  .gameover-text-area {bottom: 144px;}
  .gameover-lottie {width: calc(100% + 24em); margin-top: -144px;}
    .countdown-lottie  {transform: scale(0.8);}
}

@media (min-width: 1025px) {
  #block-game .g-hydrate-root,
  #block-game .block-g-stage, #block-game .block-g-stage > div  {
  height: 96dvh !important; }
  .block-type-g { height: 96dvh !important; }
  .block-g-exit h4 { padding-left: 0.3em; padding-right: 0.3em; }
  .coin { width: 18em; }
  .gameover-text-area {bottom: 64px;}
  .gameover-lottie {width: calc(80%); margin-top: -144px;}
  .gameover-text-area h1 {margin-bottom: 0em;}
  .gameover-coin-count h2 {margin: 0.2em 0 0.6em 0;}
  .gameover-cta {margin-top: 2.4em;}
  .countdown-lottie  {transform: scale(0.65);}
}

/* in block-type-g.css */
.block-type-g.fake-fs {
  position: fixed; inset: 0;
  width: 100vw; height: 100svh;
  z-index: 1500; background: #000;
}

/* When game mode is active, take over the viewport */
body.game-mode-active .block-type-g.ingame {
  position: fixed !important;
  inset: 0 !important;
  width: 100vw !important;
  height: 100dvh !important;
  z-index: 9999 !important;
  margin: 0;
  padding: 0;
  background: #000; /* smoother transition under canvas */
  /* avoid rubber band / pull-to-refresh while playing */
  overscroll-behavior: none;
  touch-action: none; /* optional: blocks pinch/zoom during gameplay */
}

/* Ensure the q5 host div fills the screen */
body.game-mode-active .block-type-g.ingame .evade-the-rock {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
}

/* Put HUD above the canvas */
.block-type-g .countdown-bg-overlay,
.block-type-g .countdown-lottie,
.block-type-g .countdown-display,
.block-type-g .coin-counter,
.block-type-g .exit-button,
.block-type-g .game-over {
  position: absolute; /* if not already */
  z-index: 2;          /* canvas is at z:0 by default */
}

/* When element is in true native Fullscreen, also force fill */
:fullscreen.block-type-g.ingame,
:-webkit-full-screen.block-type-g.ingame {
  position: fixed !important;
  inset: 0 !important;
  width: 100vw !important;
  height: 100dvh !important;
  z-index: 9999 !important;
}

:fullscreen .evade-the-rock,
:-webkit-full-screen .evade-the-rock {
  position: absolute;
  inset: 0;
}

/* Optional: keep nav behind during play */
body.game-mode-active .nav-menu { z-index: 0 !important; }

/* Optional: keep pane scroller inert while playing */
body.game-mode-active .SnappyScrollThingy {
  overflow: hidden !important;
}

/* Root node for the portal. Exists only when created, empty otherwise. */
#game-viewport-root {
  position: fixed;
  inset: 0;
  z-index: 10050; /* above your 9999 */
  pointer-events: none; /* children opt-in */
}

/* The actual overlay layer (the one we portal). */
#game-viewport-root .game-viewport-layer {
  position: fixed;
  inset: 0;
  width: 100vw;
  height: 100dvh;
  background: #000;
  pointer-events: auto;
  overflow: hidden;
  /* performance niceties */
  contain: layout paint;
  will-change: transform;
  backface-visibility: hidden;
}

/* Your HUD/canvas positioning already uses fixed/absolute â€“ all still valid. */
